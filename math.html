<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ch. 4 Math | Matplotlib with Rmarkdown</title>
<meta name="author" content="Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/toc.css">
<link rel="stylesheet" href="fontawesome/css/all.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Matplotlib with Rmarkdown</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="python-environments.html"><span class="header-section-number">2</span> Python environments</a></li>
<li><a class="" href="sharing-data-objects.html"><span class="header-section-number">3</span> Sharing data objects</a></li>
<li><a class="active" href="math.html"><span class="header-section-number">4</span> Math</a></li>
<li><a class="" href="scientific.html"><span class="header-section-number">5</span> Scientific</a></li>
<li><a class="" href="voxels.html"><span class="header-section-number">6</span> Voxels</a></li>
<li><a class="" href="seaborn.html"><span class="header-section-number">7</span> Seaborn</a></li>
<li><a class="" href="advanced.html"><span class="header-section-number">8</span> Advanced</a></li>
<li><a class="" href="beyond-matplotlib.html"><span class="header-section-number">9</span> Beyond matplotlib</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com//f0nzie/matplotlib-with-rmarkdown">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="math" class="section level1" number="4">
<h1>
<span class="header-section-number">Ch. 4</span> Math<a class="anchor" aria-label="anchor" href="#math"><i class="fas fa-link"></i></a>
</h1>
<p><em>Last update: Thu Nov 5 19:22:01 2020 -0600 (5124cef)</em></p>
<div class="decocode">
<div style="background-color:#4C78DB">
<p><span style="font-size:90%;color:#ffffff"><i class="fab fa-r-project"></i><b>R</b></span></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/reticulate">reticulate</a></span><span class="op">)</span>
<span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/use_python.html">use_condaenv</a></span><span class="op">(</span><span class="st">"r-python"</span><span class="op">)</span></code></pre></div>
</div>
<br>
</div>
<div id="functions" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Functions<a class="anchor" aria-label="anchor" href="#functions"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="math.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.geeksforgeeks.org/plot-mathematical-expressions-in-python-using-matplotlib/</span></span>
<span id="cb34-2"><a href="math.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries </span></span>
<span id="cb34-3"><a href="math.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb34-4"><a href="math.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb34-5"><a href="math.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-6"><a href="math.html#cb34-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">50</span>) </span>
<span id="cb34-7"><a href="math.html#cb34-7" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">14</span>, <span class="dv">8</span>)) </span>
<span id="cb34-8"><a href="math.html#cb34-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-9"><a href="math.html#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot y = cos(x) </span></span>
<span id="cb34-10"><a href="math.html#cb34-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.cos(x) </span>
<span id="cb34-11"><a href="math.html#cb34-11" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, <span class="st">'b'</span>, label <span class="op">=</span><span class="st">'cos(x)'</span>) </span>
<span id="cb34-12"><a href="math.html#cb34-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-13"><a href="math.html#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot degree 2 Taylor polynomial </span></span>
<span id="cb34-14"><a href="math.html#cb34-14" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb34-15"><a href="math.html#cb34-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y2, <span class="st">'r-.'</span>, label <span class="op">=</span><span class="st">'Degree 2'</span>) </span>
<span id="cb34-16"><a href="math.html#cb34-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-17"><a href="math.html#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot degree 4 Taylor polynomial </span></span>
<span id="cb34-18"><a href="math.html#cb34-18" aria-hidden="true" tabindex="-1"></a>y4 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> x<span class="op">**</span><span class="dv">4</span> <span class="op">/</span> <span class="dv">24</span></span>
<span id="cb34-19"><a href="math.html#cb34-19" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y4, <span class="st">'g:'</span>, label <span class="op">=</span><span class="st">'Degree 4'</span>) </span>
<span id="cb34-20"><a href="math.html#cb34-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-21"><a href="math.html#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add features to our figure </span></span>
<span id="cb34-22"><a href="math.html#cb34-22" aria-hidden="true" tabindex="-1"></a>plt.legend() </span>
<span id="cb34-23"><a href="math.html#cb34-23" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, linestyle <span class="op">=</span><span class="st">':'</span>) </span>
<span id="cb34-24"><a href="math.html#cb34-24" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>]) </span>
<span id="cb34-25"><a href="math.html#cb34-25" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>]) </span>
<span id="cb34-26"><a href="math.html#cb34-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-27"><a href="math.html#cb34-27" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Taylor Polynomials of cos(x) at x = 0'</span>) </span>
<span id="cb34-28"><a href="math.html#cb34-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x-axis'</span>) </span>
<span id="cb34-29"><a href="math.html#cb34-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'y-axis'</span>) </span>
<span id="cb34-30"><a href="math.html#cb34-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-31"><a href="math.html#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Show plot </span></span>
<span id="cb34-32"><a href="math.html#cb34-32" aria-hidden="true" tabindex="-1"></a>plt.show() </span></code></pre></div>
<img src="04-math_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="functions-with-latex-labels" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Functions with Latex labels<a class="anchor" aria-label="anchor" href="#functions-with-latex-labels"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="math.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.kaggle.com/sskiing/matplotlib-showcase-examples</span></span>
<span id="cb35-2"><a href="math.html#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="math.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-4"><a href="math.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb35-5"><a href="math.html#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Polygon</span>
<span id="cb35-6"><a href="math.html#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="math.html#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> func(x):</span>
<span id="cb35-8"><a href="math.html#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">-</span> <span class="dv">3</span>) <span class="op">*</span> (x <span class="op">-</span> <span class="dv">5</span>) <span class="op">*</span> (x <span class="op">-</span> <span class="dv">7</span>) <span class="op">+</span> <span class="dv">85</span></span>
<span id="cb35-9"><a href="math.html#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="math.html#cb35-10" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">2</span>, <span class="dv">9</span>  <span class="co"># integral limits</span></span>
<span id="cb35-11"><a href="math.html#cb35-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb35-12"><a href="math.html#cb35-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> func(x)</span>
<span id="cb35-13"><a href="math.html#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="math.html#cb35-14" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(dpi<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb35-15"><a href="math.html#cb35-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, <span class="st">'r'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb35-16"><a href="math.html#cb35-16" aria-hidden="true" tabindex="-1"></a>plt.ylim(ymin<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb35-17"><a href="math.html#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="math.html#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the shaded region</span></span>
<span id="cb35-19"><a href="math.html#cb35-19" aria-hidden="true" tabindex="-1"></a>ix <span class="op">=</span> np.linspace(a, b)</span>
<span id="cb35-20"><a href="math.html#cb35-20" aria-hidden="true" tabindex="-1"></a>iy <span class="op">=</span> func(ix)</span>
<span id="cb35-21"><a href="math.html#cb35-21" aria-hidden="true" tabindex="-1"></a>verts <span class="op">=</span> [(a, <span class="dv">0</span>)] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">zip</span>(ix, iy)) <span class="op">+</span> [(b, <span class="dv">0</span>)]</span>
<span id="cb35-22"><a href="math.html#cb35-22" aria-hidden="true" tabindex="-1"></a>poly <span class="op">=</span> Polygon(verts, facecolor<span class="op">=</span><span class="st">'0.9'</span>, edgecolor<span class="op">=</span><span class="st">'0.5'</span>)</span>
<span id="cb35-23"><a href="math.html#cb35-23" aria-hidden="true" tabindex="-1"></a>ax.add_patch(poly)</span>
<span id="cb35-24"><a href="math.html#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="math.html#cb35-25" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">0.5</span> <span class="op">*</span> (a <span class="op">+</span> b), <span class="dv">30</span>, <span class="vs">r"$\int_a^b f(x)\mathrm</span><span class="sc">{d}</span><span class="vs">x$"</span>,</span>
<span id="cb35-26"><a href="math.html#cb35-26" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb35-27"><a href="math.html#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="math.html#cb35-28" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.9</span>, <span class="fl">0.05</span>, <span class="st">'$x$'</span>)</span>
<span id="cb35-29"><a href="math.html#cb35-29" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="st">'$y$'</span>)</span>
<span id="cb35-30"><a href="math.html#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="math.html#cb35-31" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb35-32"><a href="math.html#cb35-32" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb35-33"><a href="math.html#cb35-33" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_ticks_position(<span class="st">'bottom'</span>)</span>
<span id="cb35-34"><a href="math.html#cb35-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-35"><a href="math.html#cb35-35" aria-hidden="true" tabindex="-1"></a>ax.set_xticks((a, b))</span>
<span id="cb35-36"><a href="math.html#cb35-36" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels((<span class="st">'$a$'</span>, <span class="st">'$b$'</span>))</span>
<span id="cb35-37"><a href="math.html#cb35-37" aria-hidden="true" tabindex="-1"></a>ax.set_yticks([])</span>
<span id="cb35-38"><a href="math.html#cb35-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="04-math_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="multiple-functions-in-the-same-plot" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Multiple functions in the same plot<a class="anchor" aria-label="anchor" href="#multiple-functions-in-the-same-plot"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="math.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb36-2"><a href="math.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-3"><a href="math.html#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="math.html#cb36-4" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="fl">0.0</span>, <span class="fl">2.0</span>, <span class="fl">0.01</span>)</span>
<span id="cb36-5"><a href="math.html#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="math.html#cb36-6" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">=</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> t)</span>
<span id="cb36-7"><a href="math.html#cb36-7" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> np.exp(<span class="op">-</span>t)</span>
<span id="cb36-8"><a href="math.html#cb36-8" aria-hidden="true" tabindex="-1"></a>s3 <span class="op">=</span> s1 <span class="op">*</span> s2</span>
<span id="cb36-9"><a href="math.html#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="math.html#cb36-10" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-11"><a href="math.html#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove horizontal space between axes</span></span>
<span id="cb36-12"><a href="math.html#cb36-12" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(hspace<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb36-13"><a href="math.html#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="math.html#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot each graph, and manually set the y tick values</span></span>
<span id="cb36-15"><a href="math.html#cb36-15" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(t, s1)</span>
<span id="cb36-16"><a href="math.html#cb36-16" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_yticks(np.arange(<span class="op">-</span><span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">0.4</span>))</span>
<span id="cb36-17"><a href="math.html#cb36-17" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb36-18"><a href="math.html#cb36-18" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(t, s2)</span>
<span id="cb36-19"><a href="math.html#cb36-19" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_yticks(np.arange(<span class="fl">0.1</span>, <span class="fl">1.0</span>, <span class="fl">0.2</span>))</span>
<span id="cb36-20"><a href="math.html#cb36-20" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb36-21"><a href="math.html#cb36-21" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(t, s3)</span>
<span id="cb36-22"><a href="math.html#cb36-22" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_yticks(np.arange(<span class="op">-</span><span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">0.4</span>))</span>
<span id="cb36-23"><a href="math.html#cb36-23" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_ylim(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb36-24"><a href="math.html#cb36-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="04-math_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="overlapping-functions" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Overlapping functions<a class="anchor" aria-label="anchor" href="#overlapping-functions"><i class="fas fa-link"></i></a>
</h2>
<p>We use <code>subplot</code> to arrange the two functions. Observe that the y-axis is the same in both functions.</p>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="math.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.python-course.eu/matplotlib_multiple_figures.php</span></span>
<span id="cb37-2"><a href="math.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb37-3"><a href="math.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb37-4"><a href="math.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(t):</span>
<span id="cb37-5"><a href="math.html#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>t) <span class="op">*</span> np.cos(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>t)</span>
<span id="cb37-6"><a href="math.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> g(t):</span>
<span id="cb37-7"><a href="math.html#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sin(t) <span class="op">*</span> np.cos(<span class="dv">1</span><span class="op">/</span>(t<span class="op">+</span><span class="fl">0.1</span>))</span>
<span id="cb37-8"><a href="math.html#cb37-8" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> np.arange(<span class="fl">0.0</span>, <span class="fl">5.0</span>, <span class="fl">0.1</span>)</span>
<span id="cb37-9"><a href="math.html#cb37-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> np.arange(<span class="fl">0.0</span>, <span class="fl">5.0</span>, <span class="fl">0.02</span>)</span>
<span id="cb37-10"><a href="math.html#cb37-10" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">212</span>)</span>
<span id="cb37-11"><a href="math.html#cb37-11" aria-hidden="true" tabindex="-1"></a>plt.plot(t1, g(t1), <span class="st">'ro'</span>, t2, f(t2), <span class="st">'k'</span>)</span>
<span id="cb37-12"><a href="math.html#cb37-12" aria-hidden="true" tabindex="-1"></a>plt.grid(color<span class="op">=</span><span class="st">'b'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb37-13"><a href="math.html#cb37-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="04-math_files/figure-html/overlapping-fun-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="surface-functions" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Surface functions<a class="anchor" aria-label="anchor" href="#surface-functions"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="math.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># http://www.scipy-lectures.org/intro/matplotlib/auto_examples/plot_plot3d_ex.html</span></span>
<span id="cb38-2"><a href="math.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-3"><a href="math.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb38-4"><a href="math.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb38-5"><a href="math.html#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="math.html#cb38-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb38-7"><a href="math.html#cb38-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> Axes3D(fig)</span>
<span id="cb38-8"><a href="math.html#cb38-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.25</span>)</span>
<span id="cb38-9"><a href="math.html#cb38-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.25</span>)</span>
<span id="cb38-10"><a href="math.html#cb38-10" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(X, Y)</span>
<span id="cb38-11"><a href="math.html#cb38-11" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> np.sqrt(X <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> Y <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb38-12"><a href="math.html#cb38-12" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.sin(R)</span>
<span id="cb38-13"><a href="math.html#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="math.html#cb38-14" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(X, Y, Z, rstride<span class="op">=</span><span class="dv">1</span>, cstride<span class="op">=</span><span class="dv">1</span>, cmap<span class="op">=</span>plt.cm.hot)</span>
<span id="cb38-15"><a href="math.html#cb38-15" aria-hidden="true" tabindex="-1"></a>ax.contourf(X, Y, Z, zdir<span class="op">=</span><span class="st">'z'</span>, offset<span class="op">=-</span><span class="dv">2</span>, cmap<span class="op">=</span>plt.cm.hot)</span>
<span id="cb38-16"><a href="math.html#cb38-16" aria-hidden="true" tabindex="-1"></a>ax.set_zlim(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb38-17"><a href="math.html#cb38-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="04-math_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="math.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/mplot3d/offset.html#sphx-glr-gallery-mplot3d-offset-py</span></span>
<span id="cb39-2"><a href="math.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This import registers the 3D projection, but is otherwise unused.</span></span>
<span id="cb39-3"><a href="math.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D  <span class="co"># noqa: F401 unused import</span></span>
<span id="cb39-4"><a href="math.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-5"><a href="math.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-6"><a href="math.html#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="math.html#cb39-7" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb39-8"><a href="math.html#cb39-8" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.gca(projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb39-9"><a href="math.html#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="math.html#cb39-10" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.mgrid[<span class="dv">0</span>:<span class="dv">6</span><span class="op">*</span>np.pi:<span class="fl">0.25</span>, <span class="dv">0</span>:<span class="dv">4</span><span class="op">*</span>np.pi:<span class="fl">0.25</span>]</span>
<span id="cb39-11"><a href="math.html#cb39-11" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.sqrt(np.<span class="bu">abs</span>(np.cos(X) <span class="op">+</span> np.cos(Y)))</span>
<span id="cb39-12"><a href="math.html#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="math.html#cb39-13" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(X <span class="op">+</span> <span class="fl">1e5</span>, Y <span class="op">+</span> <span class="fl">1e5</span>, Z, cmap<span class="op">=</span><span class="st">'autumn'</span>, cstride<span class="op">=</span><span class="dv">2</span>, rstride<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb39-14"><a href="math.html#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="math.html#cb39-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"X label"</span>)</span>
<span id="cb39-16"><a href="math.html#cb39-16" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Y label"</span>)</span>
<span id="cb39-17"><a href="math.html#cb39-17" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">"Z label"</span>)</span>
<span id="cb39-18"><a href="math.html#cb39-18" aria-hidden="true" tabindex="-1"></a>ax.set_zlim(<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb39-19"><a href="math.html#cb39-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="04-math_files/figure-html/sqrt-cos-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
<p>This is the typical example that you find in all <code>Matlab</code> books and tutorials.</p>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="math.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/matplotlib/matplotlib/blob/master/examples/mplot3d/surface3d_radial.py</span></span>
<span id="cb40-2"><a href="math.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D  <span class="co"># noqa: F401 unused import</span></span>
<span id="cb40-3"><a href="math.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb40-4"><a href="math.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb40-5"><a href="math.html#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="math.html#cb40-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb40-7"><a href="math.html#cb40-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb40-8"><a href="math.html#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="math.html#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the mesh in polar coordinates and compute corresponding Z.</span></span>
<span id="cb40-10"><a href="math.html#cb40-10" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="fl">1.25</span>, <span class="dv">50</span>)</span>
<span id="cb40-11"><a href="math.html#cb40-11" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="dv">50</span>)</span>
<span id="cb40-12"><a href="math.html#cb40-12" aria-hidden="true" tabindex="-1"></a>R, P <span class="op">=</span> np.meshgrid(r, p)</span>
<span id="cb40-13"><a href="math.html#cb40-13" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> ((R<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb40-14"><a href="math.html#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Express the mesh in the cartesian system.</span></span>
<span id="cb40-15"><a href="math.html#cb40-15" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> R<span class="op">*</span>np.cos(P), R<span class="op">*</span>np.sin(P)</span>
<span id="cb40-16"><a href="math.html#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the surface.</span></span>
<span id="cb40-17"><a href="math.html#cb40-17" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(X, Y, Z, cmap<span class="op">=</span>plt.cm.YlGnBu_r)</span>
<span id="cb40-18"><a href="math.html#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Tweak the limits and add latex math labels.</span></span>
<span id="cb40-19"><a href="math.html#cb40-19" aria-hidden="true" tabindex="-1"></a>ax.set_zlim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-20"><a href="math.html#cb40-20" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r'$\phi_\mathrm</span><span class="sc">{real}</span><span class="vs">$'</span>)</span>
<span id="cb40-21"><a href="math.html#cb40-21" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$\phi_\mathrm</span><span class="sc">{im}</span><span class="vs">$'</span>)</span>
<span id="cb40-22"><a href="math.html#cb40-22" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="vs">r'$V(\phi)$'</span>)</span>
<span id="cb40-23"><a href="math.html#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="math.html#cb40-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="04-math_files/figure-html/hat-fun-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="d-wireframe" class="section level2" number="4.6">
<h2>
<span class="header-section-number">4.6</span> 3D wireframe<a class="anchor" aria-label="anchor" href="#d-wireframe"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="math.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/matplotlib/matplotlib/blob/master/examples/mplot3d/wire3d.py</span></span>
<span id="cb41-2"><a href="math.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> axes3d</span>
<span id="cb41-3"><a href="math.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb41-4"><a href="math.html#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="math.html#cb41-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb41-6"><a href="math.html#cb41-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb41-7"><a href="math.html#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="math.html#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Grab some test data.</span></span>
<span id="cb41-9"><a href="math.html#cb41-9" aria-hidden="true" tabindex="-1"></a>X, Y, Z <span class="op">=</span> axes3d.get_test_data(<span class="fl">0.05</span>)</span>
<span id="cb41-10"><a href="math.html#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="math.html#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a basic wireframe.</span></span>
<span id="cb41-12"><a href="math.html#cb41-12" aria-hidden="true" tabindex="-1"></a>ax.plot_wireframe(X, Y, Z, rstride<span class="op">=</span><span class="dv">10</span>, cstride<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb41-13"><a href="math.html#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="math.html#cb41-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="04-math_files/figure-html/wireframe-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="d-contour-plot" class="section level2" number="4.7">
<h2>
<span class="header-section-number">4.7</span> 3D contour plot<a class="anchor" aria-label="anchor" href="#d-contour-plot"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="math.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/2.0.2/examples/mplot3d/contour3d_demo.html</span></span>
<span id="cb42-2"><a href="math.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> axes3d</span>
<span id="cb42-3"><a href="math.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb42-4"><a href="math.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span>
<span id="cb42-5"><a href="math.html#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="math.html#cb42-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb42-7"><a href="math.html#cb42-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb42-8"><a href="math.html#cb42-8" aria-hidden="true" tabindex="-1"></a>X, Y, Z <span class="op">=</span> axes3d.get_test_data(<span class="fl">0.05</span>)</span>
<span id="cb42-9"><a href="math.html#cb42-9" aria-hidden="true" tabindex="-1"></a>cset <span class="op">=</span> ax.contour(X, Y, Z, cmap<span class="op">=</span>cm.coolwarm)</span>
<span id="cb42-10"><a href="math.html#cb42-10" aria-hidden="true" tabindex="-1"></a>ax.clabel(cset, fontsize<span class="op">=</span><span class="dv">9</span>, inline<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb42-11"><a href="math.html#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="math.html#cb42-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="04-math_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="machine-learning" class="section level2" number="4.8">
<h2>
<span class="header-section-number">4.8</span> Machine Learning<a class="anchor" aria-label="anchor" href="#machine-learning"><i class="fas fa-link"></i></a>
</h2>
<p>This is just one sample of discovering patterns with machine learning.</p>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="math.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb43-2"><a href="math.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb43-3"><a href="math.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> neighbors, datasets</span>
<span id="cb43-4"><a href="math.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> ListedColormap</span>
<span id="cb43-5"><a href="math.html#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="math.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create color maps for 3-class classification problem, as with iris</span></span>
<span id="cb43-7"><a href="math.html#cb43-7" aria-hidden="true" tabindex="-1"></a>cmap_light <span class="op">=</span> ListedColormap([<span class="st">'#FFAAAA'</span>,<span class="st">'#AAFFAA'</span>,<span class="st">'#AAAAFF'</span>])</span>
<span id="cb43-8"><a href="math.html#cb43-8" aria-hidden="true" tabindex="-1"></a>cmap_bold <span class="op">=</span> ListedColormap([<span class="st">'#FF0000'</span>,<span class="st">'#00FF00'</span>,<span class="st">'#0000FF'</span>])</span>
<span id="cb43-9"><a href="math.html#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="math.html#cb43-10" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> datasets.load_iris()</span>
<span id="cb43-11"><a href="math.html#cb43-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> iris.data[:, :<span class="dv">2</span>]  <span class="co"># we only take the first two features. We could</span></span>
<span id="cb43-12"><a href="math.html#cb43-12" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># avoid this ugly slicing by using a two-dim dataset</span></span>
<span id="cb43-13"><a href="math.html#cb43-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> iris.target</span>
<span id="cb43-14"><a href="math.html#cb43-14" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> neighbors.KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-15"><a href="math.html#cb43-15" aria-hidden="true" tabindex="-1"></a>knn.fit(X, y)</span>
<span id="cb43-16"><a href="math.html#cb43-16" aria-hidden="true" tabindex="-1"></a>x_min, x_max <span class="op">=</span> X[:, <span class="dv">0</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="fl">.1</span>, X[:, <span class="dv">0</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="fl">.1</span></span>
<span id="cb43-17"><a href="math.html#cb43-17" aria-hidden="true" tabindex="-1"></a>y_min, y_max <span class="op">=</span> X[:, <span class="dv">1</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="fl">.1</span>, X[:, <span class="dv">1</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="fl">.1</span></span>
<span id="cb43-18"><a href="math.html#cb43-18" aria-hidden="true" tabindex="-1"></a>xx, yy <span class="op">=</span> np.meshgrid(np.linspace(x_min, x_max, <span class="dv">100</span>), np.linspace(y_min, y_max, <span class="dv">100</span>))</span>
<span id="cb43-19"><a href="math.html#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="math.html#cb43-20" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> knn.predict(np.c_[xx.ravel(), yy.ravel()])</span>
<span id="cb43-21"><a href="math.html#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="math.html#cb43-22" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Z.reshape(xx.shape)</span>
<span id="cb43-23"><a href="math.html#cb43-23" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb43-24"><a href="math.html#cb43-24" aria-hidden="true" tabindex="-1"></a>plt.pcolormesh(xx, yy, Z, cmap<span class="op">=</span>cmap_light)</span>
<span id="cb43-25"><a href="math.html#cb43-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-26"><a href="math.html#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot also the training points</span></span>
<span id="cb43-27"><a href="math.html#cb43-27" aria-hidden="true" tabindex="-1"></a>plt.scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>], c<span class="op">=</span>y, cmap<span class="op">=</span>cmap_bold)</span>
<span id="cb43-28"><a href="math.html#cb43-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'sepal length (cm)'</span>)</span>
<span id="cb43-29"><a href="math.html#cb43-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'sepal width (cm)'</span>)</span>
<span id="cb43-30"><a href="math.html#cb43-30" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'tight'</span>)</span>
<span id="cb43-31"><a href="math.html#cb43-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="04-math_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="sharing-data-objects.html"><span class="header-section-number">3</span> Sharing data objects</a></div>
<div class="next"><a href="scientific.html"><span class="header-section-number">5</span> Scientific</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#math"><span class="header-section-number">4</span> Math</a></li>
<li><a class="nav-link" href="#functions"><span class="header-section-number">4.1</span> Functions</a></li>
<li><a class="nav-link" href="#functions-with-latex-labels"><span class="header-section-number">4.2</span> Functions with Latex labels</a></li>
<li><a class="nav-link" href="#multiple-functions-in-the-same-plot"><span class="header-section-number">4.3</span> Multiple functions in the same plot</a></li>
<li><a class="nav-link" href="#overlapping-functions"><span class="header-section-number">4.4</span> Overlapping functions</a></li>
<li><a class="nav-link" href="#surface-functions"><span class="header-section-number">4.5</span> Surface functions</a></li>
<li><a class="nav-link" href="#d-wireframe"><span class="header-section-number">4.6</span> 3D wireframe</a></li>
<li><a class="nav-link" href="#d-contour-plot"><span class="header-section-number">4.7</span> 3D contour plot</a></li>
<li><a class="nav-link" href="#machine-learning"><span class="header-section-number">4.8</span> Machine Learning</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com//f0nzie/matplotlib-with-rmarkdown/blob/master/04-math.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com//f0nzie/matplotlib-with-rmarkdown/edit/master/04-math.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Matplotlib with Rmarkdown</strong>" was written by Alfonso R. Reyes. It was last built on 2020-11-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
