<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ch. 5 Scientific | Matplotlib with Rmarkdown</title>
<meta name="author" content="Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/toc.css">
<link rel="stylesheet" href="fontawesome/css/all.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Matplotlib with Rmarkdown</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="python-environments.html"><span class="header-section-number">2</span> Python environments</a></li>
<li><a class="" href="sharing-data-objects.html"><span class="header-section-number">3</span> Sharing data objects</a></li>
<li><a class="" href="math.html"><span class="header-section-number">4</span> Math</a></li>
<li><a class="active" href="scientific.html"><span class="header-section-number">5</span> Scientific</a></li>
<li><a class="" href="voxels.html"><span class="header-section-number">6</span> Voxels</a></li>
<li><a class="" href="seaborn.html"><span class="header-section-number">7</span> Seaborn</a></li>
<li><a class="" href="advanced.html"><span class="header-section-number">8</span> Advanced</a></li>
<li><a class="" href="beyond-matplotlib.html"><span class="header-section-number">9</span> Beyond matplotlib</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com//f0nzie/matplotlib-with-rmarkdown">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="scientific" class="section level1" number="5">
<h1>
<span class="header-section-number">Ch. 5</span> Scientific<a class="anchor" aria-label="anchor" href="#scientific"><i class="fas fa-link"></i></a>
</h1>
<p><em>Last update: Thu Nov 19 17:17:30 2020 -0600 (f99c21d)</em></p>
<div class="decocode">
<div style="background-color:#4C78DB">
<p><span style="font-size:90%;color:#ffffff"><i class="fab fa-r-project"></i><b>R</b></span></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/reticulate">reticulate</a></span><span class="op">)</span>
<span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/use_python.html">use_condaenv</a></span><span class="op">(</span><span class="st">"r-python"</span><span class="op">)</span></code></pre></div>
</div>
<br>
</div>
<div id="solve-computational-physics-problems" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Solve Computational Physics Problems<a class="anchor" aria-label="anchor" href="#solve-computational-physics-problems"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="scientific.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.codeproject.com/Articles/1087025/Using-Python-to-Solve-Computational-Physics-Proble</span></span>
<span id="cb45-2"><a href="scientific.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb45-3"><a href="scientific.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb45-4"><a href="scientific.html#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="scientific.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set maximum iteration</span></span>
<span id="cb45-6"><a href="scientific.html#cb45-6" aria-hidden="true" tabindex="-1"></a>maxIter <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb45-7"><a href="scientific.html#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="scientific.html#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Dimension and delta</span></span>
<span id="cb45-9"><a href="scientific.html#cb45-9" aria-hidden="true" tabindex="-1"></a>lenX <span class="op">=</span> lenY <span class="op">=</span> <span class="dv">20</span> <span class="co">#we set it rectangular</span></span>
<span id="cb45-10"><a href="scientific.html#cb45-10" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb45-11"><a href="scientific.html#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="scientific.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Boundary condition</span></span>
<span id="cb45-13"><a href="scientific.html#cb45-13" aria-hidden="true" tabindex="-1"></a>Ttop <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb45-14"><a href="scientific.html#cb45-14" aria-hidden="true" tabindex="-1"></a>Tbottom <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-15"><a href="scientific.html#cb45-15" aria-hidden="true" tabindex="-1"></a>Tleft <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-16"><a href="scientific.html#cb45-16" aria-hidden="true" tabindex="-1"></a>Tright <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb45-17"><a href="scientific.html#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="scientific.html#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial guess of interior grid</span></span>
<span id="cb45-19"><a href="scientific.html#cb45-19" aria-hidden="true" tabindex="-1"></a>Tguess <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb45-20"><a href="scientific.html#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="scientific.html#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Set colour interpolation and colour map.</span></span>
<span id="cb45-22"><a href="scientific.html#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co"># You can try set it to 10, or 100 to see the difference</span></span>
<span id="cb45-23"><a href="scientific.html#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="co"># You can also try: colourMap = plt.cm.coolwarm</span></span>
<span id="cb45-24"><a href="scientific.html#cb45-24" aria-hidden="true" tabindex="-1"></a>colorinterpolation <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb45-25"><a href="scientific.html#cb45-25" aria-hidden="true" tabindex="-1"></a>colourMap <span class="op">=</span> plt.cm.jet</span>
<span id="cb45-26"><a href="scientific.html#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="scientific.html#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Set meshgrid</span></span>
<span id="cb45-28"><a href="scientific.html#cb45-28" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(np.arange(<span class="dv">0</span>, lenX), np.arange(<span class="dv">0</span>, lenY))</span>
<span id="cb45-29"><a href="scientific.html#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="scientific.html#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Set array size and set the interior value with Tguess</span></span>
<span id="cb45-31"><a href="scientific.html#cb45-31" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.empty((lenX, lenY))</span>
<span id="cb45-32"><a href="scientific.html#cb45-32" aria-hidden="true" tabindex="-1"></a>T.fill(Tguess)</span>
<span id="cb45-33"><a href="scientific.html#cb45-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-34"><a href="scientific.html#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Boundary condition</span></span>
<span id="cb45-35"><a href="scientific.html#cb45-35" aria-hidden="true" tabindex="-1"></a>T[(lenY<span class="op">-</span><span class="dv">1</span>):, :] <span class="op">=</span> Ttop</span>
<span id="cb45-36"><a href="scientific.html#cb45-36" aria-hidden="true" tabindex="-1"></a>T[:<span class="dv">1</span>, :] <span class="op">=</span> Tbottom</span>
<span id="cb45-37"><a href="scientific.html#cb45-37" aria-hidden="true" tabindex="-1"></a>T[:, (lenX<span class="op">-</span><span class="dv">1</span>):] <span class="op">=</span> Tright</span>
<span id="cb45-38"><a href="scientific.html#cb45-38" aria-hidden="true" tabindex="-1"></a>T[:, :<span class="dv">1</span>] <span class="op">=</span> Tleft</span>
<span id="cb45-39"><a href="scientific.html#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="scientific.html#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration (We assume that the iteration is convergence in maxIter = 500)</span></span>
<span id="cb45-41"><a href="scientific.html#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Please wait for a moment"</span>)</span>
<span id="cb45-42"><a href="scientific.html#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> iteration <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, maxIter):</span>
<span id="cb45-43"><a href="scientific.html#cb45-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, lenX<span class="op">-</span><span class="dv">1</span>, delta):</span>
<span id="cb45-44"><a href="scientific.html#cb45-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, lenY<span class="op">-</span><span class="dv">1</span>, delta):</span>
<span id="cb45-45"><a href="scientific.html#cb45-45" aria-hidden="true" tabindex="-1"></a>            T[i, j] <span class="op">=</span> <span class="fl">0.25</span> <span class="op">*</span> (T[i<span class="op">+</span><span class="dv">1</span>][j] <span class="op">+</span> T[i<span class="op">-</span><span class="dv">1</span>][j] <span class="op">+</span> T[i][j<span class="op">+</span><span class="dv">1</span>] <span class="op">+</span> T[i][j<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb45-46"><a href="scientific.html#cb45-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-47"><a href="scientific.html#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Iteration finished"</span>)</span>
<span id="cb45-48"><a href="scientific.html#cb45-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-49"><a href="scientific.html#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure the contour</span></span>
<span id="cb45-50"><a href="scientific.html#cb45-50" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Contour of Temperature"</span>)</span>
<span id="cb45-51"><a href="scientific.html#cb45-51" aria-hidden="true" tabindex="-1"></a>plt.contourf(X, Y, T, colorinterpolation, cmap<span class="op">=</span>colourMap)</span>
<span id="cb45-52"><a href="scientific.html#cb45-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-53"><a href="scientific.html#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Colorbar</span></span>
<span id="cb45-54"><a href="scientific.html#cb45-54" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb45-55"><a href="scientific.html#cb45-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-56"><a href="scientific.html#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result in the plot window</span></span>
<span id="cb45-57"><a href="scientific.html#cb45-57" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="find-electric-potential-in-a-square-wire" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Find electric potential in a square wire<a class="anchor" aria-label="anchor" href="#find-electric-potential-in-a-square-wire"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="scientific.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.eidos.ic.i.u-tokyo.ac.jp/~tau/lecture/computational_physics/docs/computational_physics.pdf</span></span>
<span id="cb46-2"><a href="scientific.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Page 404. Figure 17.1</span></span>
<span id="cb46-3"><a href="scientific.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve Laplace equation</span></span>
<span id="cb46-4"><a href="scientific.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> <span class="op">*</span> </span>
<span id="cb46-5"><a href="scientific.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> lab</span>
<span id="cb46-6"><a href="scientific.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb46-7"><a href="scientific.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb46-8"><a href="scientific.html#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="scientific.html#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Initializing"</span>)</span>
<span id="cb46-10"><a href="scientific.html#cb46-10" aria-hidden="true" tabindex="-1"></a>Nmax <span class="op">=</span> <span class="dv">100</span><span class="op">;</span> Niter <span class="op">=</span> <span class="dv">70</span><span class="op">;</span> V <span class="op">=</span> zeros((Nmax, Nmax), <span class="bu">float</span>) <span class="co"># float maybe Float</span></span>
<span id="cb46-11"><a href="scientific.html#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="scientific.html#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Working hard, wait for the figure while I count to 60"</span>)</span>
<span id="cb46-13"><a href="scientific.html#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, Nmax<span class="op">-</span><span class="dv">1</span>):  V[k,<span class="dv">0</span>] <span class="op">=</span> <span class="fl">100.0</span>      <span class="co"># line at 100V</span></span>
<span id="cb46-14"><a href="scientific.html#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="scientific.html#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(Niter):                       <span class="co"># iterations over algorithm</span></span>
<span id="cb46-16"><a href="scientific.html#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">iter</span> <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>: <span class="bu">print</span>(<span class="bu">iter</span>)</span>
<span id="cb46-17"><a href="scientific.html#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, Nmax<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb46-18"><a href="scientific.html#cb46-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,Nmax<span class="op">-</span><span class="dv">2</span>): V[i,j] <span class="op">=</span> <span class="fl">0.25</span> <span class="op">*</span> (V[i<span class="op">+</span><span class="dv">1</span>,j] <span class="op">+</span> V[i<span class="op">-</span><span class="dv">1</span>,j] <span class="op">+</span> V[i,j<span class="op">+</span><span class="dv">1</span>] <span class="op">+</span> V[i,j<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb46-19"><a href="scientific.html#cb46-19" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, Nmax<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>)<span class="op">;</span> y <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">2</span>)     <span class="co"># plot every other point</span></span>
<span id="cb46-20"><a href="scientific.html#cb46-20" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> lab.meshgrid(x, y)</span>
<span id="cb46-21"><a href="scientific.html#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="scientific.html#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> functz(V):                                    <span class="co"># Function returns V(x, y)</span></span>
<span id="cb46-23"><a href="scientific.html#cb46-23" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> V[X,Y]</span>
<span id="cb46-24"><a href="scientific.html#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> z</span>
<span id="cb46-25"><a href="scientific.html#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="scientific.html#cb46-26" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> functz(V)</span>
<span id="cb46-27"><a href="scientific.html#cb46-27" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> lab.figure()                          <span class="co"># Create figures</span></span>
<span id="cb46-28"><a href="scientific.html#cb46-28" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> Axes3D(fig)                            <span class="co"># plot axes</span></span>
<span id="cb46-29"><a href="scientific.html#cb46-29" aria-hidden="true" tabindex="-1"></a>ax.plot_wireframe(X, Y, Z, color <span class="op">=</span> <span class="st">'r'</span>)     <span class="co"># red wireframe</span></span>
<span id="cb46-30"><a href="scientific.html#cb46-30" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'X'</span>)                          <span class="co"># label axes</span></span>
<span id="cb46-31"><a href="scientific.html#cb46-31" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Y'</span>)</span>
<span id="cb46-32"><a href="scientific.html#cb46-32" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">'Potential'</span>)</span>
<span id="cb46-33"><a href="scientific.html#cb46-33" aria-hidden="true" tabindex="-1"></a>lab.show()                                  <span class="co"># display fig, close shell to quit</span></span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="eigenvalue-problems" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Eigenvalue problems<a class="anchor" aria-label="anchor" href="#eigenvalue-problems"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<code>lobpcg</code> (Locally Optimal Block Preconditioned Conjugate Gradient Method) * works very well in combination with <code>PyAMG</code> (example by Nathan Bell)</li>
</ul>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="scientific.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># http://scipy-lectures.org/_downloads/ScipyLectures-simple.pdf</span></span>
<span id="cb47-2"><a href="scientific.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Page 348</span></span>
<span id="cb47-3"><a href="scientific.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute eigenvectors and eigenvalues using a preconditioned eigensolver</span></span>
<span id="cb47-4"><a href="scientific.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ========================================================================</span></span>
<span id="cb47-5"><a href="scientific.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># In this example Smoothed Aggregation (SA) is used to precondition</span></span>
<span id="cb47-6"><a href="scientific.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the LOBPCG eigensolver on a two-dimensional Poisson problem with</span></span>
<span id="cb47-7"><a href="scientific.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dirichlet boundary conditions.</span></span>
<span id="cb47-8"><a href="scientific.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb47-9"><a href="scientific.html#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.sparse.linalg <span class="im">import</span> lobpcg</span>
<span id="cb47-10"><a href="scientific.html#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb47-11"><a href="scientific.html#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyamg <span class="im">import</span> smoothed_aggregation_solver</span>
<span id="cb47-12"><a href="scientific.html#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyamg.gallery <span class="im">import</span> poisson</span>
<span id="cb47-13"><a href="scientific.html#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="scientific.html#cb47-14" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb47-15"><a href="scientific.html#cb47-15" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb47-16"><a href="scientific.html#cb47-16" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> poisson((N,N), <span class="bu">format</span><span class="op">=</span><span class="st">'csr'</span>)</span>
<span id="cb47-17"><a href="scientific.html#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co"># create the AMG hierarchy</span></span>
<span id="cb47-18"><a href="scientific.html#cb47-18" aria-hidden="true" tabindex="-1"></a>ml <span class="op">=</span> smoothed_aggregation_solver(A)</span>
<span id="cb47-19"><a href="scientific.html#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co"># initial approximation to the K eigenvectors</span></span>
<span id="cb47-20"><a href="scientific.html#cb47-20" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scipy.rand(A.shape[<span class="dv">0</span>], K)</span>
<span id="cb47-21"><a href="scientific.html#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co"># preconditioner based on ml</span></span>
<span id="cb47-22"><a href="scientific.html#cb47-22" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> ml.aspreconditioner()</span>
<span id="cb47-23"><a href="scientific.html#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co"># compute eigenvalues and eigenvectors with LOBPCG</span></span>
<span id="cb47-24"><a href="scientific.html#cb47-24" aria-hidden="true" tabindex="-1"></a>W,V <span class="op">=</span> lobpcg(A, X, M<span class="op">=</span>M, tol<span class="op">=</span><span class="fl">1e-8</span>, largest<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-25"><a href="scientific.html#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="scientific.html#cb47-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">9</span>))</span>
<span id="cb47-27"><a href="scientific.html#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate through the subplots adding data points</span></span>
<span id="cb47-28"><a href="scientific.html#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(K):</span>
<span id="cb47-29"><a href="scientific.html#cb47-29" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb47-30"><a href="scientific.html#cb47-30" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Eigenvector</span><span class="sc">%d</span><span class="st">'</span><span class="op">%</span> i)</span>
<span id="cb47-31"><a href="scientific.html#cb47-31" aria-hidden="true" tabindex="-1"></a>    plt.pcolor(V[:,i].reshape(N,N))</span>
<span id="cb47-32"><a href="scientific.html#cb47-32" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">'equal'</span>)</span>
<span id="cb47-33"><a href="scientific.html#cb47-33" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb47-34"><a href="scientific.html#cb47-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="computational-physics" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Computational Physics<a class="anchor" aria-label="anchor" href="#computational-physics"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="scientific.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of the Lorenz Attractor based on Edward Lorenz's 1963 "Deterministic</span></span>
<span id="cb48-2"><a href="scientific.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nonperiodic Flow" publication.</span></span>
<span id="cb48-3"><a href="scientific.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># http://journals.ametsoc.org/doi/abs/10.1175/1520-0469%281963%29020%3C0130%3ADNF%3E2.0.CO%3B2</span></span>
<span id="cb48-4"><a href="scientific.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb48-5"><a href="scientific.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb48-6"><a href="scientific.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb48-7"><a href="scientific.html#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="scientific.html#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="scientific.html#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lorenz(x, y, z, s<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">28</span>, b<span class="op">=</span><span class="fl">2.667</span>):</span>
<span id="cb48-10"><a href="scientific.html#cb48-10" aria-hidden="true" tabindex="-1"></a>    x_dot <span class="op">=</span> s<span class="op">*</span>(y <span class="op">-</span> x)</span>
<span id="cb48-11"><a href="scientific.html#cb48-11" aria-hidden="true" tabindex="-1"></a>    y_dot <span class="op">=</span> r<span class="op">*</span>x <span class="op">-</span> y <span class="op">-</span> x<span class="op">*</span>z</span>
<span id="cb48-12"><a href="scientific.html#cb48-12" aria-hidden="true" tabindex="-1"></a>    z_dot <span class="op">=</span> x<span class="op">*</span>y <span class="op">-</span> b<span class="op">*</span>z</span>
<span id="cb48-13"><a href="scientific.html#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x_dot, y_dot, z_dot</span>
<span id="cb48-14"><a href="scientific.html#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb48-15"><a href="scientific.html#cb48-15" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb48-16"><a href="scientific.html#cb48-16" aria-hidden="true" tabindex="-1"></a>stepCnt <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb48-17"><a href="scientific.html#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Need one more for the initial values</span></span>
<span id="cb48-18"><a href="scientific.html#cb48-18" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.empty((stepCnt <span class="op">+</span> <span class="dv">1</span>,))</span>
<span id="cb48-19"><a href="scientific.html#cb48-19" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.empty((stepCnt <span class="op">+</span> <span class="dv">1</span>,))</span>
<span id="cb48-20"><a href="scientific.html#cb48-20" aria-hidden="true" tabindex="-1"></a>zs <span class="op">=</span> np.empty((stepCnt <span class="op">+</span> <span class="dv">1</span>,))</span>
<span id="cb48-21"><a href="scientific.html#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting initial values</span></span>
<span id="cb48-22"><a href="scientific.html#cb48-22" aria-hidden="true" tabindex="-1"></a>xs[<span class="dv">0</span>], ys[<span class="dv">0</span>], zs[<span class="dv">0</span>] <span class="op">=</span> (<span class="fl">0.</span>, <span class="fl">1.</span>, <span class="fl">1.05</span>)</span>
<span id="cb48-23"><a href="scientific.html#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Stepping through "time".</span></span>
<span id="cb48-24"><a href="scientific.html#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(stepCnt):</span>
<span id="cb48-25"><a href="scientific.html#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Derivatives of the X, Y, Z state</span></span>
<span id="cb48-26"><a href="scientific.html#cb48-26" aria-hidden="true" tabindex="-1"></a>    x_dot, y_dot, z_dot <span class="op">=</span> lorenz(xs[i], ys[i], zs[i])</span>
<span id="cb48-27"><a href="scientific.html#cb48-27" aria-hidden="true" tabindex="-1"></a>    xs[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> xs[i] <span class="op">+</span> (x_dot <span class="op">*</span> dt)</span>
<span id="cb48-28"><a href="scientific.html#cb48-28" aria-hidden="true" tabindex="-1"></a>    ys[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> ys[i] <span class="op">+</span> (y_dot <span class="op">*</span> dt)</span>
<span id="cb48-29"><a href="scientific.html#cb48-29" aria-hidden="true" tabindex="-1"></a>    zs[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> zs[i] <span class="op">+</span> (z_dot <span class="op">*</span> dt)</span>
<span id="cb48-30"><a href="scientific.html#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="scientific.html#cb48-31" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb48-32"><a href="scientific.html#cb48-32" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.gca(projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb48-33"><a href="scientific.html#cb48-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-34"><a href="scientific.html#cb48-34" aria-hidden="true" tabindex="-1"></a>ax.plot(xs, ys, zs, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb48-35"><a href="scientific.html#cb48-35" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"X Axis"</span>)</span>
<span id="cb48-36"><a href="scientific.html#cb48-36" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Y Axis"</span>)</span>
<span id="cb48-37"><a href="scientific.html#cb48-37" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">"Z Axis"</span>)</span>
<span id="cb48-38"><a href="scientific.html#cb48-38" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Lorenz Attractor"</span>)</span>
<span id="cb48-39"><a href="scientific.html#cb48-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-40"><a href="scientific.html#cb48-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="scientific.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/images_contours_and_fields/contour_image.html#sphx-glr-gallery-images-contours-and-fields-contour-image-py</span></span>
<span id="cb49-2"><a href="scientific.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb49-3"><a href="scientific.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb49-4"><a href="scientific.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span>
<span id="cb49-5"><a href="scientific.html#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Default delta is large because that makes it fast, and it illustrates</span></span>
<span id="cb49-6"><a href="scientific.html#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the correct registration between image and contours.</span></span>
<span id="cb49-7"><a href="scientific.html#cb49-7" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb49-8"><a href="scientific.html#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="scientific.html#cb49-9" aria-hidden="true" tabindex="-1"></a>extent <span class="op">=</span> (<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="op">-</span><span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb49-10"><a href="scientific.html#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="scientific.html#cb49-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">4.001</span>, delta)</span>
<span id="cb49-12"><a href="scientific.html#cb49-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">4.0</span>, <span class="fl">3.001</span>, delta)</span>
<span id="cb49-13"><a href="scientific.html#cb49-13" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb49-14"><a href="scientific.html#cb49-14" aria-hidden="true" tabindex="-1"></a>Z1 <span class="op">=</span> np.exp(<span class="op">-</span>X<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> Y<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb49-15"><a href="scientific.html#cb49-15" aria-hidden="true" tabindex="-1"></a>Z2 <span class="op">=</span> np.exp(<span class="op">-</span>(X <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> (Y <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb49-16"><a href="scientific.html#cb49-16" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> (Z1 <span class="op">-</span> Z2) <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb49-17"><a href="scientific.html#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="scientific.html#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Boost the upper limit to avoid truncation errors.</span></span>
<span id="cb49-19"><a href="scientific.html#cb49-19" aria-hidden="true" tabindex="-1"></a>levels <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">1.601</span>, <span class="fl">0.4</span>)</span>
<span id="cb49-20"><a href="scientific.html#cb49-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-21"><a href="scientific.html#cb49-21" aria-hidden="true" tabindex="-1"></a>norm <span class="op">=</span> cm.colors.Normalize(vmax<span class="op">=</span><span class="bu">abs</span>(Z).<span class="bu">max</span>(), vmin<span class="op">=-</span><span class="bu">abs</span>(Z).<span class="bu">max</span>())</span>
<span id="cb49-22"><a href="scientific.html#cb49-22" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> cm.PRGn</span>
<span id="cb49-23"><a href="scientific.html#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="scientific.html#cb49-24" aria-hidden="true" tabindex="-1"></a>fig, _axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb49-25"><a href="scientific.html#cb49-25" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb49-26"><a href="scientific.html#cb49-26" aria-hidden="true" tabindex="-1"></a>axs <span class="op">=</span> _axs.flatten()</span>
<span id="cb49-27"><a href="scientific.html#cb49-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-28"><a href="scientific.html#cb49-28" aria-hidden="true" tabindex="-1"></a>cset1 <span class="op">=</span> axs[<span class="dv">0</span>].contourf(X, Y, Z, levels, norm<span class="op">=</span>norm,</span>
<span id="cb49-29"><a href="scientific.html#cb49-29" aria-hidden="true" tabindex="-1"></a>                     cmap<span class="op">=</span>cm.get_cmap(cmap, <span class="bu">len</span>(levels) <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb49-30"><a href="scientific.html#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="co"># It is not necessary, but for the colormap, we need only the</span></span>
<span id="cb49-31"><a href="scientific.html#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="co"># number of levels minus 1.  To avoid discretization error, use</span></span>
<span id="cb49-32"><a href="scientific.html#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="co"># either this number or a large number such as the default (256).</span></span>
<span id="cb49-33"><a href="scientific.html#cb49-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-34"><a href="scientific.html#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="co"># If we want lines as well as filled regions, we need to call</span></span>
<span id="cb49-35"><a href="scientific.html#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="co"># contour separately; don't try to change the edgecolor or edgewidth</span></span>
<span id="cb49-36"><a href="scientific.html#cb49-36" aria-hidden="true" tabindex="-1"></a><span class="co"># of the polygons in the collections returned by contourf.</span></span>
<span id="cb49-37"><a href="scientific.html#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Use levels output from previous call to guarantee they are the same.</span></span>
<span id="cb49-38"><a href="scientific.html#cb49-38" aria-hidden="true" tabindex="-1"></a>cset2 <span class="op">=</span> axs[<span class="dv">0</span>].contour(X, Y, Z, cset1.levels, colors<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb49-39"><a href="scientific.html#cb49-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-40"><a href="scientific.html#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="co"># We don't really need dashed contour lines to indicate negative</span></span>
<span id="cb49-41"><a href="scientific.html#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="co"># regions, so let's turn them off.</span></span>
<span id="cb49-42"><a href="scientific.html#cb49-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> cset2.collections:</span>
<span id="cb49-43"><a href="scientific.html#cb49-43" aria-hidden="true" tabindex="-1"></a>    c.set_linestyle(<span class="st">'solid'</span>)</span>
<span id="cb49-44"><a href="scientific.html#cb49-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-45"><a href="scientific.html#cb49-45" aria-hidden="true" tabindex="-1"></a><span class="co"># It is easier here to make a separate call to contour than</span></span>
<span id="cb49-46"><a href="scientific.html#cb49-46" aria-hidden="true" tabindex="-1"></a><span class="co"># to set up an array of colors and linewidths.</span></span>
<span id="cb49-47"><a href="scientific.html#cb49-47" aria-hidden="true" tabindex="-1"></a><span class="co"># We are making a thick green line as a zero contour.</span></span>
<span id="cb49-48"><a href="scientific.html#cb49-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the zero level as a tuple with only 0 in it.</span></span>
<span id="cb49-49"><a href="scientific.html#cb49-49" aria-hidden="true" tabindex="-1"></a>cset3 <span class="op">=</span> axs[<span class="dv">0</span>].contour(X, Y, Z, (<span class="dv">0</span>,), colors<span class="op">=</span><span class="st">'g'</span>, linewidths<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb49-50"><a href="scientific.html#cb49-50" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">'Filled contours'</span>)</span>
<span id="cb49-51"><a href="scientific.html#cb49-51" aria-hidden="true" tabindex="-1"></a>fig.colorbar(cset1, ax<span class="op">=</span>axs[<span class="dv">0</span>])</span>
<span id="cb49-52"><a href="scientific.html#cb49-52" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].imshow(Z, extent<span class="op">=</span>extent, cmap<span class="op">=</span>cmap, norm<span class="op">=</span>norm)</span>
<span id="cb49-53"><a href="scientific.html#cb49-53" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].contour(Z, levels, colors<span class="op">=</span><span class="st">'k'</span>, origin<span class="op">=</span><span class="st">'upper'</span>, extent<span class="op">=</span>extent)</span>
<span id="cb49-54"><a href="scientific.html#cb49-54" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Image, origin 'upper'"</span>)</span>
<span id="cb49-55"><a href="scientific.html#cb49-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-56"><a href="scientific.html#cb49-56" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].imshow(Z, origin<span class="op">=</span><span class="st">'lower'</span>, extent<span class="op">=</span>extent, cmap<span class="op">=</span>cmap, norm<span class="op">=</span>norm)</span>
<span id="cb49-57"><a href="scientific.html#cb49-57" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].contour(Z, levels, colors<span class="op">=</span><span class="st">'k'</span>, origin<span class="op">=</span><span class="st">'lower'</span>, extent<span class="op">=</span>extent)</span>
<span id="cb49-58"><a href="scientific.html#cb49-58" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">"Image, origin 'lower'"</span>)</span>
<span id="cb49-59"><a href="scientific.html#cb49-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-60"><a href="scientific.html#cb49-60" aria-hidden="true" tabindex="-1"></a><span class="co"># We will use the interpolation "nearest" here to show the actual</span></span>
<span id="cb49-61"><a href="scientific.html#cb49-61" aria-hidden="true" tabindex="-1"></a><span class="co"># image pixels.</span></span>
<span id="cb49-62"><a href="scientific.html#cb49-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that the contour lines don't extend to the edge of the box.</span></span>
<span id="cb49-63"><a href="scientific.html#cb49-63" aria-hidden="true" tabindex="-1"></a><span class="co"># This is intentional. The Z values are defined at the center of each</span></span>
<span id="cb49-64"><a href="scientific.html#cb49-64" aria-hidden="true" tabindex="-1"></a><span class="co"># image pixel (each color block on the following subplot), so the</span></span>
<span id="cb49-65"><a href="scientific.html#cb49-65" aria-hidden="true" tabindex="-1"></a><span class="co"># domain that is contoured does not extend beyond these pixel centers.</span></span>
<span id="cb49-66"><a href="scientific.html#cb49-66" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> axs[<span class="dv">3</span>].imshow(Z, interpolation<span class="op">=</span><span class="st">'nearest'</span>, extent<span class="op">=</span>extent,</span>
<span id="cb49-67"><a href="scientific.html#cb49-67" aria-hidden="true" tabindex="-1"></a>                cmap<span class="op">=</span>cmap, norm<span class="op">=</span>norm)</span>
<span id="cb49-68"><a href="scientific.html#cb49-68" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].contour(Z, levels, colors<span class="op">=</span><span class="st">'k'</span>, origin<span class="op">=</span><span class="st">'image'</span>, extent<span class="op">=</span>extent)</span>
<span id="cb49-69"><a href="scientific.html#cb49-69" aria-hidden="true" tabindex="-1"></a>ylim <span class="op">=</span> axs[<span class="dv">3</span>].get_ylim()</span>
<span id="cb49-70"><a href="scientific.html#cb49-70" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].set_ylim(ylim[::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb49-71"><a href="scientific.html#cb49-71" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].set_title(<span class="st">"Origin from rc, reversed y-axis"</span>)</span>
<span id="cb49-72"><a href="scientific.html#cb49-72" aria-hidden="true" tabindex="-1"></a>fig.colorbar(im, ax<span class="op">=</span>axs[<span class="dv">3</span>])</span>
<span id="cb49-73"><a href="scientific.html#cb49-73" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb49-74"><a href="scientific.html#cb49-74" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="scientific.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/images_contours_and_fields/irregulardatagrid.html#sphx-glr-gallery-images-contours-and-fields-irregulardatagrid-py</span></span>
<span id="cb50-2"><a href="scientific.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb50-3"><a href="scientific.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.tri <span class="im">as</span> tri</span>
<span id="cb50-4"><a href="scientific.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb50-5"><a href="scientific.html#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="scientific.html#cb50-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">19680801</span>)</span>
<span id="cb50-7"><a href="scientific.html#cb50-7" aria-hidden="true" tabindex="-1"></a>npts <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb50-8"><a href="scientific.html#cb50-8" aria-hidden="true" tabindex="-1"></a>ngridx <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb50-9"><a href="scientific.html#cb50-9" aria-hidden="true" tabindex="-1"></a>ngridy <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb50-10"><a href="scientific.html#cb50-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, npts)</span>
<span id="cb50-11"><a href="scientific.html#cb50-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, npts)</span>
<span id="cb50-12"><a href="scientific.html#cb50-12" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> x <span class="op">*</span> np.exp(<span class="op">-</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> y<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb50-13"><a href="scientific.html#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="scientific.html#cb50-14" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-15"><a href="scientific.html#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="scientific.html#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------</span></span>
<span id="cb50-17"><a href="scientific.html#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpolation on a grid</span></span>
<span id="cb50-18"><a href="scientific.html#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------</span></span>
<span id="cb50-19"><a href="scientific.html#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="co"># A contour plot of irregularly spaced data coordinates</span></span>
<span id="cb50-20"><a href="scientific.html#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="co"># via interpolation on a grid.</span></span>
<span id="cb50-21"><a href="scientific.html#cb50-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-22"><a href="scientific.html#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create grid values first.</span></span>
<span id="cb50-23"><a href="scientific.html#cb50-23" aria-hidden="true" tabindex="-1"></a>xi <span class="op">=</span> np.linspace(<span class="op">-</span><span class="fl">2.1</span>, <span class="fl">2.1</span>, ngridx)</span>
<span id="cb50-24"><a href="scientific.html#cb50-24" aria-hidden="true" tabindex="-1"></a>yi <span class="op">=</span> np.linspace(<span class="op">-</span><span class="fl">2.1</span>, <span class="fl">2.1</span>, ngridy)</span>
<span id="cb50-25"><a href="scientific.html#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="scientific.html#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear interpolation of the data (x,y)</span></span>
<span id="cb50-27"><a href="scientific.html#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="co"># on a grid defined by (xi,yi)</span></span>
<span id="cb50-28"><a href="scientific.html#cb50-28" aria-hidden="true" tabindex="-1"></a>triang <span class="op">=</span> tri.Triangulation(x, y)</span>
<span id="cb50-29"><a href="scientific.html#cb50-29" aria-hidden="true" tabindex="-1"></a>interpolator <span class="op">=</span> tri.LinearTriInterpolator(triang, z)</span>
<span id="cb50-30"><a href="scientific.html#cb50-30" aria-hidden="true" tabindex="-1"></a>Xi, Yi <span class="op">=</span> np.meshgrid(xi, yi)</span>
<span id="cb50-31"><a href="scientific.html#cb50-31" aria-hidden="true" tabindex="-1"></a>zi <span class="op">=</span> interpolator(Xi, Yi)</span>
<span id="cb50-32"><a href="scientific.html#cb50-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-33"><a href="scientific.html#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that scipy.interpolate provides means to interpolate data on a grid</span></span>
<span id="cb50-34"><a href="scientific.html#cb50-34" aria-hidden="true" tabindex="-1"></a><span class="co"># as well. The following would be an alternative to the four lines above:</span></span>
<span id="cb50-35"><a href="scientific.html#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="co">#from scipy.interpolate import griddata</span></span>
<span id="cb50-36"><a href="scientific.html#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="co">#zi = griddata((x, y), z, (xi[None,:], yi[:,None]), method='linear')</span></span>
<span id="cb50-37"><a href="scientific.html#cb50-37" aria-hidden="true" tabindex="-1"></a>ax1.contour(xi, yi, zi, <span class="dv">14</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, colors<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb50-38"><a href="scientific.html#cb50-38" aria-hidden="true" tabindex="-1"></a>cntr1 <span class="op">=</span> ax1.contourf(xi, yi, zi, <span class="dv">14</span>, cmap<span class="op">=</span><span class="st">"RdBu_r"</span>)</span>
<span id="cb50-39"><a href="scientific.html#cb50-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-40"><a href="scientific.html#cb50-40" aria-hidden="true" tabindex="-1"></a>fig.colorbar(cntr1, ax<span class="op">=</span>ax1)</span>
<span id="cb50-41"><a href="scientific.html#cb50-41" aria-hidden="true" tabindex="-1"></a>ax1.plot(x, y, <span class="st">'ko'</span>, ms<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb50-42"><a href="scientific.html#cb50-42" aria-hidden="true" tabindex="-1"></a>ax1.axis((<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb50-43"><a href="scientific.html#cb50-43" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'grid and contour (</span><span class="sc">%d</span><span class="st"> points, </span><span class="sc">%d</span><span class="st"> grid points)'</span> <span class="op">%</span></span>
<span id="cb50-44"><a href="scientific.html#cb50-44" aria-hidden="true" tabindex="-1"></a>              (npts, ngridx <span class="op">*</span> ngridy))</span>
<span id="cb50-45"><a href="scientific.html#cb50-45" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------</span></span>
<span id="cb50-46"><a href="scientific.html#cb50-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Tricontour</span></span>
<span id="cb50-47"><a href="scientific.html#cb50-47" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------</span></span>
<span id="cb50-48"><a href="scientific.html#cb50-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Directly supply the unordered, irregularly spaced coordinates</span></span>
<span id="cb50-49"><a href="scientific.html#cb50-49" aria-hidden="true" tabindex="-1"></a><span class="co"># to tricontour.</span></span>
<span id="cb50-50"><a href="scientific.html#cb50-50" aria-hidden="true" tabindex="-1"></a>ax2.tricontour(x, y, z, <span class="dv">14</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, colors<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb50-51"><a href="scientific.html#cb50-51" aria-hidden="true" tabindex="-1"></a>cntr2 <span class="op">=</span> ax2.tricontourf(x, y, z, <span class="dv">14</span>, cmap<span class="op">=</span><span class="st">"RdBu_r"</span>)</span>
<span id="cb50-52"><a href="scientific.html#cb50-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-53"><a href="scientific.html#cb50-53" aria-hidden="true" tabindex="-1"></a>fig.colorbar(cntr2, ax<span class="op">=</span>ax2)</span>
<span id="cb50-54"><a href="scientific.html#cb50-54" aria-hidden="true" tabindex="-1"></a>ax2.plot(x, y, <span class="st">'ko'</span>, ms<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb50-55"><a href="scientific.html#cb50-55" aria-hidden="true" tabindex="-1"></a>ax2.axis((<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb50-56"><a href="scientific.html#cb50-56" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'tricontour (</span><span class="sc">%d</span><span class="st"> points)'</span> <span class="op">%</span> npts)</span>
<span id="cb50-57"><a href="scientific.html#cb50-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-58"><a href="scientific.html#cb50-58" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-59"><a href="scientific.html#cb50-59" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="triangulation-and-delauney-maps" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Triangulation and Delauney maps<a class="anchor" aria-label="anchor" href="#triangulation-and-delauney-maps"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="scientific.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.tri <span class="im">import</span> Triangulation, TriAnalyzer, UniformTriRefiner</span>
<span id="cb51-2"><a href="scientific.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb51-3"><a href="scientific.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb51-4"><a href="scientific.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-5"><a href="scientific.html#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb51-6"><a href="scientific.html#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Analytical test function</span></span>
<span id="cb51-7"><a href="scientific.html#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb51-8"><a href="scientific.html#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> experiment_res(x, y):</span>
<span id="cb51-9"><a href="scientific.html#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" An analytic function representing experiment results """</span></span>
<span id="cb51-10"><a href="scientific.html#cb51-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fl">2.</span> <span class="op">*</span> x</span>
<span id="cb51-11"><a href="scientific.html#cb51-11" aria-hidden="true" tabindex="-1"></a>    r1 <span class="op">=</span> np.sqrt((<span class="fl">0.5</span> <span class="op">-</span> x)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (<span class="fl">0.5</span> <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb51-12"><a href="scientific.html#cb51-12" aria-hidden="true" tabindex="-1"></a>    theta1 <span class="op">=</span> np.arctan2(<span class="fl">0.5</span> <span class="op">-</span> x, <span class="fl">0.5</span> <span class="op">-</span> y)</span>
<span id="cb51-13"><a href="scientific.html#cb51-13" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> np.sqrt((<span class="op">-</span>x <span class="op">-</span> <span class="fl">0.2</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (<span class="op">-</span>y <span class="op">-</span> <span class="fl">0.2</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb51-14"><a href="scientific.html#cb51-14" aria-hidden="true" tabindex="-1"></a>    theta2 <span class="op">=</span> np.arctan2(<span class="op">-</span>x <span class="op">-</span> <span class="fl">0.2</span>, <span class="op">-</span>y <span class="op">-</span> <span class="fl">0.2</span>)</span>
<span id="cb51-15"><a href="scientific.html#cb51-15" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> (<span class="dv">4</span> <span class="op">*</span> (np.exp((r1 <span class="op">/</span> <span class="dv">10</span>)<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="fl">30.</span> <span class="op">*</span> np.cos(<span class="dv">3</span> <span class="op">*</span> theta1) <span class="op">+</span></span>
<span id="cb51-16"><a href="scientific.html#cb51-16" aria-hidden="true" tabindex="-1"></a>         (np.exp((r2 <span class="op">/</span> <span class="dv">10</span>)<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="fl">30.</span> <span class="op">*</span> np.cos(<span class="dv">5</span> <span class="op">*</span> theta2) <span class="op">+</span></span>
<span id="cb51-17"><a href="scientific.html#cb51-17" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2</span> <span class="op">*</span> (x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb51-18"><a href="scientific.html#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (np.<span class="bu">max</span>(z) <span class="op">-</span> z) <span class="op">/</span> (np.<span class="bu">max</span>(z) <span class="op">-</span> np.<span class="bu">min</span>(z))</span>
<span id="cb51-19"><a href="scientific.html#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="scientific.html#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb51-21"><a href="scientific.html#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating the initial data test points and triangulation for the demo</span></span>
<span id="cb51-22"><a href="scientific.html#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb51-23"><a href="scientific.html#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co"># User parameters for data test points</span></span>
<span id="cb51-24"><a href="scientific.html#cb51-24" aria-hidden="true" tabindex="-1"></a>n_test <span class="op">=</span> <span class="dv">200</span>  <span class="co"># Number of test data points, tested from 3 to 5000 for subdiv=3</span></span>
<span id="cb51-25"><a href="scientific.html#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="scientific.html#cb51-26" aria-hidden="true" tabindex="-1"></a>subdiv <span class="op">=</span> <span class="dv">3</span>  <span class="co"># Number of recursive subdivisions of the initial mesh for smooth</span></span>
<span id="cb51-27"><a href="scientific.html#cb51-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># plots. Values &gt;3 might result in a very high number of triangles</span></span>
<span id="cb51-28"><a href="scientific.html#cb51-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># for the refine mesh: new triangles numbering = (4**subdiv)*ntri</span></span>
<span id="cb51-29"><a href="scientific.html#cb51-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-30"><a href="scientific.html#cb51-30" aria-hidden="true" tabindex="-1"></a>init_mask_frac <span class="op">=</span> <span class="fl">0.0</span>    <span class="co"># Float &gt; 0. adjusting the proportion of</span></span>
<span id="cb51-31"><a href="scientific.html#cb51-31" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># (invalid) initial triangles which will be masked</span></span>
<span id="cb51-32"><a href="scientific.html#cb51-32" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># out. Enter 0 for no mask.</span></span>
<span id="cb51-33"><a href="scientific.html#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="scientific.html#cb51-34" aria-hidden="true" tabindex="-1"></a>min_circle_ratio <span class="op">=</span> <span class="fl">.01</span>  <span class="co"># Minimum circle ratio - border triangles with circle</span></span>
<span id="cb51-35"><a href="scientific.html#cb51-35" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># ratio below this will be masked if they touch a</span></span>
<span id="cb51-36"><a href="scientific.html#cb51-36" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># border. Suggested value 0.01; use -1 to keep</span></span>
<span id="cb51-37"><a href="scientific.html#cb51-37" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># all triangles.</span></span>
<span id="cb51-38"><a href="scientific.html#cb51-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-39"><a href="scientific.html#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Random points</span></span>
<span id="cb51-40"><a href="scientific.html#cb51-40" aria-hidden="true" tabindex="-1"></a>random_gen <span class="op">=</span> np.random.RandomState(seed<span class="op">=</span><span class="dv">19680801</span>)</span>
<span id="cb51-41"><a href="scientific.html#cb51-41" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> random_gen.uniform(<span class="op">-</span><span class="fl">1.</span>, <span class="fl">1.</span>, size<span class="op">=</span>n_test)</span>
<span id="cb51-42"><a href="scientific.html#cb51-42" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> random_gen.uniform(<span class="op">-</span><span class="fl">1.</span>, <span class="fl">1.</span>, size<span class="op">=</span>n_test)</span>
<span id="cb51-43"><a href="scientific.html#cb51-43" aria-hidden="true" tabindex="-1"></a>z_test <span class="op">=</span> experiment_res(x_test, y_test)</span>
<span id="cb51-44"><a href="scientific.html#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="co"># meshing with Delaunay triangulation</span></span>
<span id="cb51-45"><a href="scientific.html#cb51-45" aria-hidden="true" tabindex="-1"></a>tri <span class="op">=</span> Triangulation(x_test, y_test)</span>
<span id="cb51-46"><a href="scientific.html#cb51-46" aria-hidden="true" tabindex="-1"></a>ntri <span class="op">=</span> tri.triangles.shape[<span class="dv">0</span>]</span>
<span id="cb51-47"><a href="scientific.html#cb51-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Some invalid data are masked out</span></span>
<span id="cb51-48"><a href="scientific.html#cb51-48" aria-hidden="true" tabindex="-1"></a>mask_init <span class="op">=</span> np.zeros(ntri, dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb51-49"><a href="scientific.html#cb51-49" aria-hidden="true" tabindex="-1"></a>masked_tri <span class="op">=</span> random_gen.randint(<span class="dv">0</span>, ntri, <span class="bu">int</span>(ntri <span class="op">*</span> init_mask_frac))</span>
<span id="cb51-50"><a href="scientific.html#cb51-50" aria-hidden="true" tabindex="-1"></a>mask_init[masked_tri] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb51-51"><a href="scientific.html#cb51-51" aria-hidden="true" tabindex="-1"></a>tri.set_mask(mask_init)</span>
<span id="cb51-52"><a href="scientific.html#cb51-52" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb51-53"><a href="scientific.html#cb51-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Improving the triangulation before high-res plots: removing flat triangles</span></span>
<span id="cb51-54"><a href="scientific.html#cb51-54" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb51-55"><a href="scientific.html#cb51-55" aria-hidden="true" tabindex="-1"></a><span class="co"># masking badly shaped triangles at the border of the triangular mesh.</span></span>
<span id="cb51-56"><a href="scientific.html#cb51-56" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> TriAnalyzer(tri).get_flat_tri_mask(min_circle_ratio)</span>
<span id="cb51-57"><a href="scientific.html#cb51-57" aria-hidden="true" tabindex="-1"></a>tri.set_mask(mask)</span>
<span id="cb51-58"><a href="scientific.html#cb51-58" aria-hidden="true" tabindex="-1"></a><span class="co"># refining the data</span></span>
<span id="cb51-59"><a href="scientific.html#cb51-59" aria-hidden="true" tabindex="-1"></a>refiner <span class="op">=</span> UniformTriRefiner(tri)</span>
<span id="cb51-60"><a href="scientific.html#cb51-60" aria-hidden="true" tabindex="-1"></a>tri_refi, z_test_refi <span class="op">=</span> refiner.refine_field(z_test, subdiv<span class="op">=</span>subdiv)</span>
<span id="cb51-61"><a href="scientific.html#cb51-61" aria-hidden="true" tabindex="-1"></a><span class="co"># analytical 'results' for comparison</span></span>
<span id="cb51-62"><a href="scientific.html#cb51-62" aria-hidden="true" tabindex="-1"></a>z_expected <span class="op">=</span> experiment_res(tri_refi.x, tri_refi.y)</span>
<span id="cb51-63"><a href="scientific.html#cb51-63" aria-hidden="true" tabindex="-1"></a><span class="co"># for the demo: loading the 'flat' triangles for plot</span></span>
<span id="cb51-64"><a href="scientific.html#cb51-64" aria-hidden="true" tabindex="-1"></a>flat_tri <span class="op">=</span> Triangulation(x_test, y_test)</span>
<span id="cb51-65"><a href="scientific.html#cb51-65" aria-hidden="true" tabindex="-1"></a>flat_tri.set_mask(<span class="op">~</span>mask)</span>
<span id="cb51-66"><a href="scientific.html#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb51-67"><a href="scientific.html#cb51-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Now the plots</span></span>
<span id="cb51-68"><a href="scientific.html#cb51-68" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb51-69"><a href="scientific.html#cb51-69" aria-hidden="true" tabindex="-1"></a><span class="co"># User options for plots</span></span>
<span id="cb51-70"><a href="scientific.html#cb51-70" aria-hidden="true" tabindex="-1"></a>plot_tri <span class="op">=</span> <span class="va">True</span>          <span class="co"># plot of base triangulation</span></span>
<span id="cb51-71"><a href="scientific.html#cb51-71" aria-hidden="true" tabindex="-1"></a>plot_masked_tri <span class="op">=</span> <span class="va">True</span>   <span class="co"># plot of excessively flat excluded triangles</span></span>
<span id="cb51-72"><a href="scientific.html#cb51-72" aria-hidden="true" tabindex="-1"></a>plot_refi_tri <span class="op">=</span> <span class="va">False</span>    <span class="co"># plot of refined triangulation</span></span>
<span id="cb51-73"><a href="scientific.html#cb51-73" aria-hidden="true" tabindex="-1"></a>plot_expected <span class="op">=</span> <span class="va">False</span>    <span class="co"># plot of analytical function values for comparison</span></span>
<span id="cb51-74"><a href="scientific.html#cb51-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-75"><a href="scientific.html#cb51-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphical options for tricontouring</span></span>
<span id="cb51-76"><a href="scientific.html#cb51-76" aria-hidden="true" tabindex="-1"></a>levels <span class="op">=</span> np.arange(<span class="fl">0.</span>, <span class="fl">1.</span>, <span class="fl">0.025</span>)</span>
<span id="cb51-77"><a href="scientific.html#cb51-77" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> cm.get_cmap(name<span class="op">=</span><span class="st">'Blues'</span>, lut<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb51-78"><a href="scientific.html#cb51-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-79"><a href="scientific.html#cb51-79" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb51-80"><a href="scientific.html#cb51-80" aria-hidden="true" tabindex="-1"></a>ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb51-81"><a href="scientific.html#cb51-81" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Filtering a Delaunay mesh</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span></span>
<span id="cb51-82"><a href="scientific.html#cb51-82" aria-hidden="true" tabindex="-1"></a>          <span class="st">"(application to high-resolution tricontouring)"</span>)</span>
<span id="cb51-83"><a href="scientific.html#cb51-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-84"><a href="scientific.html#cb51-84" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) plot of the refined (computed) data contours:</span></span>
<span id="cb51-85"><a href="scientific.html#cb51-85" aria-hidden="true" tabindex="-1"></a>ax.tricontour(tri_refi, z_test_refi, levels<span class="op">=</span>levels, cmap<span class="op">=</span>cmap,</span>
<span id="cb51-86"><a href="scientific.html#cb51-86" aria-hidden="true" tabindex="-1"></a>               linewidths<span class="op">=</span>[<span class="fl">2.0</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>])</span>
<span id="cb51-87"><a href="scientific.html#cb51-87" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) plot of the expected (analytical) data contours (dashed):</span></span>
<span id="cb51-88"><a href="scientific.html#cb51-88" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> plot_expected:</span>
<span id="cb51-89"><a href="scientific.html#cb51-89" aria-hidden="true" tabindex="-1"></a>    ax.tricontour(tri_refi, z_expected, levels<span class="op">=</span>levels, cmap<span class="op">=</span>cmap,</span>
<span id="cb51-90"><a href="scientific.html#cb51-90" aria-hidden="true" tabindex="-1"></a>                   linestyles<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb51-91"><a href="scientific.html#cb51-91" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) plot of the fine mesh on which interpolation was done:</span></span>
<span id="cb51-92"><a href="scientific.html#cb51-92" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> plot_refi_tri:</span>
<span id="cb51-93"><a href="scientific.html#cb51-93" aria-hidden="true" tabindex="-1"></a>    ax.triplot(tri_refi, color<span class="op">=</span><span class="st">'0.97'</span>)</span>
<span id="cb51-94"><a href="scientific.html#cb51-94" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) plot of the initial 'coarse' mesh:</span></span>
<span id="cb51-95"><a href="scientific.html#cb51-95" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> plot_tri:</span>
<span id="cb51-96"><a href="scientific.html#cb51-96" aria-hidden="true" tabindex="-1"></a>    ax.triplot(tri, color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb51-97"><a href="scientific.html#cb51-97" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) plot of the unvalidated triangles from naive Delaunay Triangulation:</span></span>
<span id="cb51-98"><a href="scientific.html#cb51-98" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> plot_masked_tri:</span>
<span id="cb51-99"><a href="scientific.html#cb51-99" aria-hidden="true" tabindex="-1"></a>    ax.triplot(flat_tri, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb51-100"><a href="scientific.html#cb51-100" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="scientific.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/images_contours_and_fields/triinterp_demo.html#sphx-glr-gallery-images-contours-and-fields-triinterp-demo-py</span></span>
<span id="cb52-2"><a href="scientific.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb52-3"><a href="scientific.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.tri <span class="im">as</span> mtri</span>
<span id="cb52-4"><a href="scientific.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb52-5"><a href="scientific.html#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="scientific.html#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create triangulation.</span></span>
<span id="cb52-7"><a href="scientific.html#cb52-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.asarray([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">1.5</span>])</span>
<span id="cb52-8"><a href="scientific.html#cb52-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.asarray([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">3.0</span>])</span>
<span id="cb52-9"><a href="scientific.html#cb52-9" aria-hidden="true" tabindex="-1"></a>triangles <span class="op">=</span> [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>], [<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">4</span>], [<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">5</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb52-10"><a href="scientific.html#cb52-10" aria-hidden="true" tabindex="-1"></a>             [<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>], [<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">7</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]]</span>
<span id="cb52-11"><a href="scientific.html#cb52-11" aria-hidden="true" tabindex="-1"></a>triang <span class="op">=</span> mtri.Triangulation(x, y, triangles)</span>
<span id="cb52-12"><a href="scientific.html#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="scientific.html#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpolate to regularly-spaced quad grid.</span></span>
<span id="cb52-14"><a href="scientific.html#cb52-14" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.cos(<span class="fl">1.5</span> <span class="op">*</span> x) <span class="op">*</span> np.cos(<span class="fl">1.5</span> <span class="op">*</span> y)</span>
<span id="cb52-15"><a href="scientific.html#cb52-15" aria-hidden="true" tabindex="-1"></a>xi, yi <span class="op">=</span> np.meshgrid(np.linspace(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">20</span>), np.linspace(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">20</span>))</span>
<span id="cb52-16"><a href="scientific.html#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="scientific.html#cb52-17" aria-hidden="true" tabindex="-1"></a>interp_lin <span class="op">=</span> mtri.LinearTriInterpolator(triang, z)</span>
<span id="cb52-18"><a href="scientific.html#cb52-18" aria-hidden="true" tabindex="-1"></a>zi_lin <span class="op">=</span> interp_lin(xi, yi)</span>
<span id="cb52-19"><a href="scientific.html#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="scientific.html#cb52-20" aria-hidden="true" tabindex="-1"></a>interp_cubic_geom <span class="op">=</span> mtri.CubicTriInterpolator(triang, z, kind<span class="op">=</span><span class="st">'geom'</span>)</span>
<span id="cb52-21"><a href="scientific.html#cb52-21" aria-hidden="true" tabindex="-1"></a>zi_cubic_geom <span class="op">=</span> interp_cubic_geom(xi, yi)</span>
<span id="cb52-22"><a href="scientific.html#cb52-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-23"><a href="scientific.html#cb52-23" aria-hidden="true" tabindex="-1"></a>interp_cubic_min_E <span class="op">=</span> mtri.CubicTriInterpolator(triang, z, kind<span class="op">=</span><span class="st">'min_E'</span>)</span>
<span id="cb52-24"><a href="scientific.html#cb52-24" aria-hidden="true" tabindex="-1"></a>zi_cubic_min_E <span class="op">=</span> interp_cubic_min_E(xi, yi)</span>
<span id="cb52-25"><a href="scientific.html#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="scientific.html#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the figure</span></span>
<span id="cb52-27"><a href="scientific.html#cb52-27" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb52-28"><a href="scientific.html#cb52-28" aria-hidden="true" tabindex="-1"></a>axs <span class="op">=</span> axs.flatten()</span>
<span id="cb52-29"><a href="scientific.html#cb52-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-30"><a href="scientific.html#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the triangulation.</span></span>
<span id="cb52-31"><a href="scientific.html#cb52-31" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].tricontourf(triang, z)</span>
<span id="cb52-32"><a href="scientific.html#cb52-32" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].triplot(triang, <span class="st">'ko-'</span>)</span>
<span id="cb52-33"><a href="scientific.html#cb52-33" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">'Triangular grid'</span>)</span>
<span id="cb52-34"><a href="scientific.html#cb52-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-35"><a href="scientific.html#cb52-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot linear interpolation to quad grid.</span></span>
<span id="cb52-36"><a href="scientific.html#cb52-36" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].contourf(xi, yi, zi_lin)</span>
<span id="cb52-37"><a href="scientific.html#cb52-37" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(xi, yi, <span class="st">'k-'</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb52-38"><a href="scientific.html#cb52-38" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(xi.T, yi.T, <span class="st">'k-'</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb52-39"><a href="scientific.html#cb52-39" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Linear interpolation"</span>)</span>
<span id="cb52-40"><a href="scientific.html#cb52-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-41"><a href="scientific.html#cb52-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cubic interpolation to quad grid, kind=geom</span></span>
<span id="cb52-42"><a href="scientific.html#cb52-42" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].contourf(xi, yi, zi_cubic_geom)</span>
<span id="cb52-43"><a href="scientific.html#cb52-43" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(xi, yi, <span class="st">'k-'</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb52-44"><a href="scientific.html#cb52-44" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(xi.T, yi.T, <span class="st">'k-'</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb52-45"><a href="scientific.html#cb52-45" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">"Cubic interpolation,</span><span class="ch">\n</span><span class="st">kind='geom'"</span>)</span>
<span id="cb52-46"><a href="scientific.html#cb52-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-47"><a href="scientific.html#cb52-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cubic interpolation to quad grid, kind=min_E</span></span>
<span id="cb52-48"><a href="scientific.html#cb52-48" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].contourf(xi, yi, zi_cubic_min_E)</span>
<span id="cb52-49"><a href="scientific.html#cb52-49" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].plot(xi, yi, <span class="st">'k-'</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb52-50"><a href="scientific.html#cb52-50" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].plot(xi.T, yi.T, <span class="st">'k-'</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb52-51"><a href="scientific.html#cb52-51" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].set_title(<span class="st">"Cubic interpolation,</span><span class="ch">\n</span><span class="st">kind='min_E'"</span>)</span>
<span id="cb52-52"><a href="scientific.html#cb52-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-53"><a href="scientific.html#cb52-53" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb52-54"><a href="scientific.html#cb52-54" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="contour-maps" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> Contour maps<a class="anchor" aria-label="anchor" href="#contour-maps"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="scientific.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># http://www.scipy-lectures.org/intro/matplotlib/auto_examples/plot_contour_ex.html</span></span>
<span id="cb53-2"><a href="scientific.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb53-3"><a href="scientific.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-4"><a href="scientific.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="scientific.html#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="scientific.html#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x, y):</span>
<span id="cb53-7"><a href="scientific.html#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span> <span class="op">-</span> x <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> x <span class="op">**</span> <span class="dv">5</span> <span class="op">+</span> y <span class="op">**</span> <span class="dv">3</span>) <span class="op">*</span> np.exp(<span class="op">-</span>x <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span>y <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb53-8"><a href="scientific.html#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="scientific.html#cb53-9" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">256</span></span>
<span id="cb53-10"><a href="scientific.html#cb53-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, n)</span>
<span id="cb53-11"><a href="scientific.html#cb53-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, n)</span>
<span id="cb53-12"><a href="scientific.html#cb53-12" aria-hidden="true" tabindex="-1"></a>X,Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb53-13"><a href="scientific.html#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="scientific.html#cb53-14" aria-hidden="true" tabindex="-1"></a>plt.axes([<span class="fl">0.025</span>, <span class="fl">0.025</span>, <span class="fl">0.95</span>, <span class="fl">0.95</span>])</span>
<span id="cb53-15"><a href="scientific.html#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="scientific.html#cb53-16" aria-hidden="true" tabindex="-1"></a>plt.contourf(X, Y, f(X, Y), <span class="dv">8</span>, alpha<span class="op">=</span><span class="fl">.75</span>, cmap<span class="op">=</span>plt.cm.hot)</span>
<span id="cb53-17"><a href="scientific.html#cb53-17" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> plt.contour(X, Y, f(X, Y), <span class="dv">8</span>, colors<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb53-18"><a href="scientific.html#cb53-18" aria-hidden="true" tabindex="-1"></a>plt.clabel(C, inline<span class="op">=</span><span class="dv">1</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb53-19"><a href="scientific.html#cb53-19" aria-hidden="true" tabindex="-1"></a>plt.xticks(())</span>
<span id="cb53-20"><a href="scientific.html#cb53-20" aria-hidden="true" tabindex="-1"></a>plt.yticks(())</span>
<span id="cb53-21"><a href="scientific.html#cb53-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="real-time" class="section level2" number="5.7">
<h2>
<span class="header-section-number">5.7</span> Real time<a class="anchor" aria-label="anchor" href="#real-time"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="scientific.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/lines_bars_and_markers/cohere.html#sphx-glr-gallery-lines-bars-and-markers-cohere-py</span></span>
<span id="cb54-2"><a href="scientific.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb54-3"><a href="scientific.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb54-4"><a href="scientific.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixing random state for reproducibility</span></span>
<span id="cb54-5"><a href="scientific.html#cb54-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">19680801</span>)</span>
<span id="cb54-6"><a href="scientific.html#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="scientific.html#cb54-7" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb54-8"><a href="scientific.html#cb54-8" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">30</span>, dt)</span>
<span id="cb54-9"><a href="scientific.html#cb54-9" aria-hidden="true" tabindex="-1"></a>nse1 <span class="op">=</span> np.random.randn(<span class="bu">len</span>(t))                 <span class="co"># white noise 1</span></span>
<span id="cb54-10"><a href="scientific.html#cb54-10" aria-hidden="true" tabindex="-1"></a>nse2 <span class="op">=</span> np.random.randn(<span class="bu">len</span>(t))                 <span class="co"># white noise 2</span></span>
<span id="cb54-11"><a href="scientific.html#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="scientific.html#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Two signals with a coherent part at 10Hz and a random part</span></span>
<span id="cb54-13"><a href="scientific.html#cb54-13" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">=</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> <span class="dv">10</span> <span class="op">*</span> t) <span class="op">+</span> nse1</span>
<span id="cb54-14"><a href="scientific.html#cb54-14" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> <span class="dv">10</span> <span class="op">*</span> t) <span class="op">+</span> nse2</span>
<span id="cb54-15"><a href="scientific.html#cb54-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-16"><a href="scientific.html#cb54-16" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb54-17"><a href="scientific.html#cb54-17" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(t, s1, t, s2)</span>
<span id="cb54-18"><a href="scientific.html#cb54-18" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlim(<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb54-19"><a href="scientific.html#cb54-19" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'time'</span>)</span>
<span id="cb54-20"><a href="scientific.html#cb54-20" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'s1 and s2'</span>)</span>
<span id="cb54-21"><a href="scientific.html#cb54-21" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb54-22"><a href="scientific.html#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="scientific.html#cb54-23" aria-hidden="true" tabindex="-1"></a>cxy, f <span class="op">=</span> axs[<span class="dv">1</span>].cohere(s1, s2, <span class="dv">256</span>, <span class="fl">1.</span> <span class="op">/</span> dt)</span>
<span id="cb54-24"><a href="scientific.html#cb54-24" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'coherence'</span>)</span>
<span id="cb54-25"><a href="scientific.html#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="scientific.html#cb54-26" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb54-27"><a href="scientific.html#cb54-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="scientific.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/scales/symlog_demo.html#sphx-glr-gallery-scales-symlog-demo-py</span></span>
<span id="cb55-2"><a href="scientific.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb55-3"><a href="scientific.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb55-4"><a href="scientific.html#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="scientific.html#cb55-5" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb55-6"><a href="scientific.html#cb55-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">50.0</span>, <span class="fl">50.0</span>, dt)</span>
<span id="cb55-7"><a href="scientific.html#cb55-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="fl">100.0</span>, dt)</span>
<span id="cb55-8"><a href="scientific.html#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="scientific.html#cb55-9" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">311</span>)</span>
<span id="cb55-10"><a href="scientific.html#cb55-10" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y)</span>
<span id="cb55-11"><a href="scientific.html#cb55-11" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'symlog'</span>)</span>
<span id="cb55-12"><a href="scientific.html#cb55-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'symlogx'</span>)</span>
<span id="cb55-13"><a href="scientific.html#cb55-13" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb55-14"><a href="scientific.html#cb55-14" aria-hidden="true" tabindex="-1"></a>plt.gca().xaxis.grid(<span class="va">True</span>, which<span class="op">=</span><span class="st">'minor'</span>)  <span class="co"># minor grid on too</span></span>
<span id="cb55-15"><a href="scientific.html#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="scientific.html#cb55-16" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">312</span>)</span>
<span id="cb55-17"><a href="scientific.html#cb55-17" aria-hidden="true" tabindex="-1"></a>plt.plot(y, x)</span>
<span id="cb55-18"><a href="scientific.html#cb55-18" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">'symlog'</span>)</span>
<span id="cb55-19"><a href="scientific.html#cb55-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'symlogy'</span>)</span>
<span id="cb55-20"><a href="scientific.html#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="scientific.html#cb55-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">313</span>)</span>
<span id="cb55-22"><a href="scientific.html#cb55-22" aria-hidden="true" tabindex="-1"></a>plt.plot(x, np.sin(x <span class="op">/</span> <span class="fl">3.0</span>))</span>
<span id="cb55-23"><a href="scientific.html#cb55-23" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'symlog'</span>)</span>
<span id="cb55-24"><a href="scientific.html#cb55-24" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">'symlog'</span>, linthreshy<span class="op">=</span><span class="fl">0.015</span>)</span>
<span id="cb55-25"><a href="scientific.html#cb55-25" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb55-26"><a href="scientific.html#cb55-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'symlog both'</span>)</span>
<span id="cb55-27"><a href="scientific.html#cb55-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-28"><a href="scientific.html#cb55-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb55-29"><a href="scientific.html#cb55-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="scientific.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/lines_bars_and_markers/step_demo.html#sphx-glr-gallery-lines-bars-and-markers-step-demo-py</span></span>
<span id="cb56-2"><a href="scientific.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb56-3"><a href="scientific.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> ma</span>
<span id="cb56-4"><a href="scientific.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb56-5"><a href="scientific.html#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="scientific.html#cb56-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">7</span>, <span class="fl">0.4</span>)</span>
<span id="cb56-7"><a href="scientific.html#cb56-7" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.sin(x)</span>
<span id="cb56-8"><a href="scientific.html#cb56-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y0.copy() <span class="op">+</span> <span class="fl">2.5</span></span>
<span id="cb56-9"><a href="scientific.html#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="scientific.html#cb56-10" aria-hidden="true" tabindex="-1"></a>plt.step(x, y, label<span class="op">=</span><span class="st">'pre (default)'</span>)</span>
<span id="cb56-11"><a href="scientific.html#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="scientific.html#cb56-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">-=</span> <span class="fl">0.5</span></span>
<span id="cb56-13"><a href="scientific.html#cb56-13" aria-hidden="true" tabindex="-1"></a>plt.step(x, y, where<span class="op">=</span><span class="st">'mid'</span>, label<span class="op">=</span><span class="st">'mid'</span>)</span>
<span id="cb56-14"><a href="scientific.html#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="scientific.html#cb56-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">-=</span> <span class="fl">0.5</span></span>
<span id="cb56-16"><a href="scientific.html#cb56-16" aria-hidden="true" tabindex="-1"></a>plt.step(x, y, where<span class="op">=</span><span class="st">'post'</span>, label<span class="op">=</span><span class="st">'post'</span>)</span>
<span id="cb56-17"><a href="scientific.html#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="scientific.html#cb56-18" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ma.masked_where((y0 <span class="op">&gt;</span> <span class="op">-</span><span class="fl">0.15</span>) <span class="op">&amp;</span> (y0 <span class="op">&lt;</span> <span class="fl">0.15</span>), y <span class="op">-</span> <span class="fl">0.5</span>)</span>
<span id="cb56-19"><a href="scientific.html#cb56-19" aria-hidden="true" tabindex="-1"></a>plt.step(x, y, label<span class="op">=</span><span class="st">'masked (pre)'</span>)</span>
<span id="cb56-20"><a href="scientific.html#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="scientific.html#cb56-21" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb56-22"><a href="scientific.html#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="scientific.html#cb56-23" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb56-24"><a href="scientific.html#cb56-24" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">4</span>)</span>
<span id="cb56-25"><a href="scientific.html#cb56-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>
</div>
<div id="density-plots" class="section level2" number="5.8">
<h2>
<span class="header-section-number">5.8</span> Density plots<a class="anchor" aria-label="anchor" href="#density-plots"><i class="fas fa-link"></i></a>
</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i><b>Python</b></span></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="scientific.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://blogs.umass.edu/candela/computational-physics-in-python/</span></span>
<span id="cb57-2"><a href="scientific.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the interference from two point sources, vectorized version.</span></span>
<span id="cb57-3"><a href="scientific.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb57-4"><a href="scientific.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb57-5"><a href="scientific.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> pi,sqrt,sin</span>
<span id="cb57-6"><a href="scientific.html#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="scientific.html#cb57-7" aria-hidden="true" tabindex="-1"></a>wavelength <span class="op">=</span> <span class="fl">5e-2</span>     <span class="co"># wavelength (m) (this is 5cm as in Newman)</span></span>
<span id="cb57-8"><a href="scientific.html#cb57-8" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span>wavelength   <span class="co"># wavenumber (m^-1)</span></span>
<span id="cb57-9"><a href="scientific.html#cb57-9" aria-hidden="true" tabindex="-1"></a>aa0 <span class="op">=</span> <span class="fl">1.0</span>             <span class="co"># amplitude of the waves (arb. units)</span></span>
<span id="cb57-10"><a href="scientific.html#cb57-10" aria-hidden="true" tabindex="-1"></a>separation <span class="op">=</span> <span class="fl">20e-2</span>    <span class="co"># separation of centers (m)</span></span>
<span id="cb57-11"><a href="scientific.html#cb57-11" aria-hidden="true" tabindex="-1"></a>side <span class="op">=</span> <span class="fl">100e-2</span>         <span class="co"># side of the square (m)</span></span>
<span id="cb57-12"><a href="scientific.html#cb57-12" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> <span class="dv">500</span>          <span class="co"># number of grid points along each side</span></span>
<span id="cb57-13"><a href="scientific.html#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="scientific.html#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the positions of the centers of the circles</span></span>
<span id="cb57-15"><a href="scientific.html#cb57-15" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> side<span class="op">/</span><span class="dv">2</span> <span class="op">+</span> separation<span class="op">/</span><span class="dv">2</span></span>
<span id="cb57-16"><a href="scientific.html#cb57-16" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> side<span class="op">/</span><span class="dv">2</span></span>
<span id="cb57-17"><a href="scientific.html#cb57-17" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> side<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> separation<span class="op">/</span><span class="dv">2</span></span>
<span id="cb57-18"><a href="scientific.html#cb57-18" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> side<span class="op">/</span><span class="dv">2</span></span>
<span id="cb57-19"><a href="scientific.html#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="scientific.html#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate an array aas with the sum of the two waves at a grid of points</span></span>
<span id="cb57-21"><a href="scientific.html#cb57-21" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.linspace(<span class="dv">0</span>,side,points)                 <span class="co"># row vector of x's</span></span>
<span id="cb57-22"><a href="scientific.html#cb57-22" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.linspace(<span class="dv">0</span>,side,points)[:,np.newaxis]   <span class="co"># column vector of y's</span></span>
<span id="cb57-23"><a href="scientific.html#cb57-23" aria-hidden="true" tabindex="-1"></a>r1s <span class="op">=</span> sqrt((xs<span class="op">-</span>x1)<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(ys<span class="op">-</span>y1)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb57-24"><a href="scientific.html#cb57-24" aria-hidden="true" tabindex="-1"></a>r2s <span class="op">=</span> sqrt((xs<span class="op">-</span>x2)<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(ys<span class="op">-</span>y2)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb57-25"><a href="scientific.html#cb57-25" aria-hidden="true" tabindex="-1"></a>aas <span class="op">=</span> aa0<span class="op">*</span>sin(k<span class="op">*</span>r1s) <span class="op">+</span> aa0<span class="op">*</span>sin(k<span class="op">*</span>r2s)</span>
<span id="cb57-26"><a href="scientific.html#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="scientific.html#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb57-28"><a href="scientific.html#cb57-28" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>)) </span>
<span id="cb57-29"><a href="scientific.html#cb57-29" aria-hidden="true" tabindex="-1"></a>plt.imshow(aas,origin<span class="op">=</span><span class="st">'lower'</span>,extent<span class="op">=</span>[<span class="dv">0</span>,side,<span class="dv">0</span>,side])</span>
<span id="cb57-30"><a href="scientific.html#cb57-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x (m)'</span>)</span>
<span id="cb57-31"><a href="scientific.html#cb57-31" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'y (m)'</span>)</span>
<span id="cb57-32"><a href="scientific.html#cb57-32" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.gray()</span></span>
<span id="cb57-33"><a href="scientific.html#cb57-33" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb57-34"><a href="scientific.html#cb57-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/interference-1.png" width="90%" style="display: block; margin: auto;">
</div>
<br>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="math.html"><span class="header-section-number">4</span> Math</a></div>
<div class="next"><a href="voxels.html"><span class="header-section-number">6</span> Voxels</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#scientific"><span class="header-section-number">5</span> Scientific</a></li>
<li><a class="nav-link" href="#solve-computational-physics-problems"><span class="header-section-number">5.1</span> Solve Computational Physics Problems</a></li>
<li><a class="nav-link" href="#find-electric-potential-in-a-square-wire"><span class="header-section-number">5.2</span> Find electric potential in a square wire</a></li>
<li><a class="nav-link" href="#eigenvalue-problems"><span class="header-section-number">5.3</span> Eigenvalue problems</a></li>
<li><a class="nav-link" href="#computational-physics"><span class="header-section-number">5.4</span> Computational Physics</a></li>
<li><a class="nav-link" href="#triangulation-and-delauney-maps"><span class="header-section-number">5.5</span> Triangulation and Delauney maps</a></li>
<li><a class="nav-link" href="#contour-maps"><span class="header-section-number">5.6</span> Contour maps</a></li>
<li><a class="nav-link" href="#real-time"><span class="header-section-number">5.7</span> Real time</a></li>
<li><a class="nav-link" href="#density-plots"><span class="header-section-number">5.8</span> Density plots</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com//f0nzie/matplotlib-with-rmarkdown/blob/master/05-scientific.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com//f0nzie/matplotlib-with-rmarkdown/edit/master/05-scientific.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Matplotlib with Rmarkdown</strong>" was written by Alfonso R. Reyes. It was last built on 2020-12-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
