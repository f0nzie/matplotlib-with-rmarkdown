<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Ch. 5 Scientific | Matplotlib with Rmarkdown</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Ch. 5 Scientific | Matplotlib with Rmarkdown" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="/f0nzie/matplotlib-with-rmarkdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Ch. 5 Scientific | Matplotlib with Rmarkdown" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Alfonso R. Reyes" />


<meta name="date" content="2020-11-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="math.html"/>
<link rel="next" href="voxels.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="fontawesome/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Matplotlib with Rmarkdown</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#method"><i class="fa fa-check"></i>Method</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-engine"><i class="fa fa-check"></i>R engine</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bash-engine"><i class="fa fa-check"></i>Bash engine</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#python-engine"><i class="fa fa-check"></i>Python engine</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#hello-world"><i class="fa fa-check"></i><b>1.1</b> “Hello world”</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-parts-of-a-plot"><i class="fa fa-check"></i><b>1.2</b> The parts of a plot</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#can-do-business-plots-too"><i class="fa fa-check"></i><b>1.3</b> Can do business plots too</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#and-real-time"><i class="fa fa-check"></i><b>1.4</b> And real time</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#and-also-3d"><i class="fa fa-check"></i><b>1.5</b> And also 3D</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="python-environments.html"><a href="python-environments.html"><i class="fa fa-check"></i><b>2</b> Python environments</a>
<ul>
<li class="chapter" data-level="2.1" data-path="python-environments.html"><a href="python-environments.html#why-virtual-environments"><i class="fa fa-check"></i><b>2.1</b> Why virtual environments?</a></li>
<li class="chapter" data-level="2.2" data-path="python-environments.html"><a href="python-environments.html#python-virtual-environment-and-r"><i class="fa fa-check"></i><b>2.2</b> Python virtual environment and R</a></li>
<li class="chapter" data-level="2.3" data-path="python-environments.html"><a href="python-environments.html#conda-environments"><i class="fa fa-check"></i><b>2.3</b> conda environments</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="python-environments.html"><a href="python-environments.html#environment-with-python-version-specified"><i class="fa fa-check"></i><b>2.3.1</b> environment with Python version specified</a></li>
<li class="chapter" data-level="2.3.2" data-path="python-environments.html"><a href="python-environments.html#specify-python-version-and-list-package-names"><i class="fa fa-check"></i><b>2.3.2</b> specify Python version and list package names</a></li>
<li class="chapter" data-level="2.3.3" data-path="python-environments.html"><a href="python-environments.html#specify-python-version-and-version-for-the-packages"><i class="fa fa-check"></i><b>2.3.3</b> specify Python version and version for the packages</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="python-environments.html"><a href="python-environments.html#running-python-from-r"><i class="fa fa-check"></i><b>2.4</b> Running Python from R</a></li>
<li class="chapter" data-level="2.5" data-path="python-environments.html"><a href="python-environments.html#a-plot-demo"><i class="fa fa-check"></i><b>2.5</b> A plot demo</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sharing-data-objects.html"><a href="sharing-data-objects.html"><i class="fa fa-check"></i><b>3</b> Sharing data objects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sharing-data-objects.html"><a href="sharing-data-objects.html#from-r-to-python-back-to-r"><i class="fa fa-check"></i><b>3.1</b> From R to Python, back to R</a></li>
<li class="chapter" data-level="3.2" data-path="sharing-data-objects.html"><a href="sharing-data-objects.html#from-python-to-r-back-to-python"><i class="fa fa-check"></i><b>3.2</b> From Python to R, back to Python</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="math.html"><a href="math.html"><i class="fa fa-check"></i><b>4</b> Math</a>
<ul>
<li class="chapter" data-level="4.1" data-path="math.html"><a href="math.html#functions"><i class="fa fa-check"></i><b>4.1</b> Functions</a></li>
<li class="chapter" data-level="4.2" data-path="math.html"><a href="math.html#functions-with-latex-labels"><i class="fa fa-check"></i><b>4.2</b> Functions with Latex labels</a></li>
<li class="chapter" data-level="4.3" data-path="math.html"><a href="math.html#multiple-functions-in-the-same-plot"><i class="fa fa-check"></i><b>4.3</b> Multiple functions in the same plot</a></li>
<li class="chapter" data-level="4.4" data-path="math.html"><a href="math.html#overlapping-functions"><i class="fa fa-check"></i><b>4.4</b> Overlapping functions</a></li>
<li class="chapter" data-level="4.5" data-path="math.html"><a href="math.html#surface-functions"><i class="fa fa-check"></i><b>4.5</b> Surface functions</a></li>
<li class="chapter" data-level="4.6" data-path="math.html"><a href="math.html#d-wireframe"><i class="fa fa-check"></i><b>4.6</b> 3D wireframe</a></li>
<li class="chapter" data-level="4.7" data-path="math.html"><a href="math.html#d-contour-plot"><i class="fa fa-check"></i><b>4.7</b> 3D contour plot</a></li>
<li class="chapter" data-level="4.8" data-path="math.html"><a href="math.html#machine-learning"><i class="fa fa-check"></i><b>4.8</b> Machine Learning</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="scientific.html"><a href="scientific.html"><i class="fa fa-check"></i><b>5</b> Scientific</a>
<ul>
<li class="chapter" data-level="5.1" data-path="scientific.html"><a href="scientific.html#solving-laplace"><i class="fa fa-check"></i><b>5.1</b> Solving Laplace</a></li>
<li class="chapter" data-level="5.2" data-path="scientific.html"><a href="scientific.html#eigenvalue-problems"><i class="fa fa-check"></i><b>5.2</b> Eigenvalue problems</a></li>
<li class="chapter" data-level="5.3" data-path="scientific.html"><a href="scientific.html#computational-physics"><i class="fa fa-check"></i><b>5.3</b> Computational Physics</a></li>
<li class="chapter" data-level="5.4" data-path="scientific.html"><a href="scientific.html#triangulation-and-delauney-maps"><i class="fa fa-check"></i><b>5.4</b> Triangulation and Delauney maps</a></li>
<li class="chapter" data-level="5.5" data-path="scientific.html"><a href="scientific.html#contour-maps"><i class="fa fa-check"></i><b>5.5</b> Contour maps</a></li>
<li class="chapter" data-level="5.6" data-path="scientific.html"><a href="scientific.html#real-time"><i class="fa fa-check"></i><b>5.6</b> Real time</a></li>
<li class="chapter" data-level="5.7" data-path="scientific.html"><a href="scientific.html#density-plots"><i class="fa fa-check"></i><b>5.7</b> Density plots</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="voxels.html"><a href="voxels.html"><i class="fa fa-check"></i><b>6</b> Voxels</a>
<ul>
<li class="chapter" data-level="6.1" data-path="voxels.html"><a href="voxels.html#radial"><i class="fa fa-check"></i><b>6.1</b> Radial</a></li>
<li class="chapter" data-level="6.2" data-path="voxels.html"><a href="voxels.html#spherical"><i class="fa fa-check"></i><b>6.2</b> Spherical</a></li>
<li class="chapter" data-level="6.3" data-path="voxels.html"><a href="voxels.html#solid-cubes"><i class="fa fa-check"></i><b>6.3</b> Solid cubes</a></li>
<li class="chapter" data-level="6.4" data-path="voxels.html"><a href="voxels.html#transparent-cubicles"><i class="fa fa-check"></i><b>6.4</b> Transparent cubicles</a></li>
<li class="chapter" data-level="6.5" data-path="voxels.html"><a href="voxels.html#semi-transparent"><i class="fa fa-check"></i><b>6.5</b> Semi-transparent</a></li>
<li class="chapter" data-level="6.6" data-path="voxels.html"><a href="voxels.html#opaque-cubicles"><i class="fa fa-check"></i><b>6.6</b> Opaque cubicles</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="seaborn.html"><a href="seaborn.html"><i class="fa fa-check"></i><b>7</b> Seaborn</a>
<ul>
<li class="chapter" data-level="7.1" data-path="seaborn.html"><a href="seaborn.html#error-bands"><i class="fa fa-check"></i><b>7.1</b> Error bands</a></li>
<li class="chapter" data-level="7.2" data-path="seaborn.html"><a href="seaborn.html#boxplots"><i class="fa fa-check"></i><b>7.2</b> Boxplots</a></li>
<li class="chapter" data-level="7.3" data-path="seaborn.html"><a href="seaborn.html#facets"><i class="fa fa-check"></i><b>7.3</b> Facets</a></li>
<li class="chapter" data-level="7.4" data-path="seaborn.html"><a href="seaborn.html#functions-1"><i class="fa fa-check"></i><b>7.4</b> Functions</a></li>
<li class="chapter" data-level="7.5" data-path="seaborn.html"><a href="seaborn.html#scatter-plot-matrix"><i class="fa fa-check"></i><b>7.5</b> Scatter plot matrix</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>8</b> Advanced</a>
<ul>
<li class="chapter" data-level="8.1" data-path="advanced.html"><a href="advanced.html#adding-labels"><i class="fa fa-check"></i><b>8.1</b> Adding labels</a></li>
<li class="chapter" data-level="8.2" data-path="advanced.html"><a href="advanced.html#subplots"><i class="fa fa-check"></i><b>8.2</b> Subplots</a></li>
<li class="chapter" data-level="8.3" data-path="advanced.html"><a href="advanced.html#change-of-axes"><i class="fa fa-check"></i><b>8.3</b> Change of axes</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html"><i class="fa fa-check"></i><b>9</b> Beyond <code>matplotlib</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#brokenaxis"><i class="fa fa-check"></i><b>9.1</b> <code>brokenaxis</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#usage"><i class="fa fa-check"></i><b>9.1.1</b> Usage</a></li>
<li class="chapter" data-level="9.1.2" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#subplots-1"><i class="fa fa-check"></i><b>9.1.2</b> Subplots</a></li>
<li class="chapter" data-level="9.1.3" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#log-scales"><i class="fa fa-check"></i><b>9.1.3</b> Log scales</a></li>
<li class="chapter" data-level="9.1.4" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#different-scales"><i class="fa fa-check"></i><b>9.1.4</b> Different scales</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#yellowbrick"><i class="fa fa-check"></i><b>9.2</b> <code>yellowbrick</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#pearson-correlation"><i class="fa fa-check"></i><b>9.2.1</b> Pearson correlation</a></li>
<li class="chapter" data-level="9.2.2" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#scatter-diagram"><i class="fa fa-check"></i><b>9.2.2</b> Scatter diagram</a></li>
<li class="chapter" data-level="9.2.3" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#residuals-plot"><i class="fa fa-check"></i><b>9.2.3</b> Residuals plot</a></li>
<li class="chapter" data-level="9.2.4" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#discrimination-threshold"><i class="fa fa-check"></i><b>9.2.4</b> Discrimination threshold</a></li>
<li class="chapter" data-level="9.2.5" data-path="beyond-matplotlib.html"><a href="beyond-matplotlib.html#intercluster-distance"><i class="fa fa-check"></i><b>9.2.5</b> Intercluster distance</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Matplotlib with Rmarkdown</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scientific" class="section level1" number="5">
<h1><span class="header-section-number">Ch. 5</span> Scientific</h1>
<p><em>Last update: Thu Nov 5 14:04:38 2020 -0600 (afafa56)</em></p>
<div class="decocode">
<div style="background-color:#4C78DB">
<p><span style="font-size:90%;color:#ffffff"><i class="fab fa-r-project"></i> <b>R</b></span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="scientific.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb43-2"><a href="scientific.html#cb43-2" aria-hidden="true" tabindex="-1"></a>reticulate<span class="sc">::</span><span class="fu">use_condaenv</span>(<span class="st">&quot;r-python&quot;</span>)</span></code></pre></div>
</div>
<br>
</div>
<div id="solving-laplace" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Solving Laplace</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="scientific.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.eidos.ic.i.u-tokyo.ac.jp/~tau/lecture/computational_physics/docs/computational_physics.pdf</span></span>
<span id="cb44-2"><a href="scientific.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Page </span></span>
<span id="cb44-3"><a href="scientific.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve Laplace equation</span></span>
<span id="cb44-4"><a href="scientific.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> <span class="op">*</span> </span>
<span id="cb44-5"><a href="scientific.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> p<span class="op">;</span></span>
<span id="cb44-6"><a href="scientific.html#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb44-7"><a href="scientific.html#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="scientific.html#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Initializing&quot;</span>)</span>
<span id="cb44-9"><a href="scientific.html#cb44-9" aria-hidden="true" tabindex="-1"></a>Nmax <span class="op">=</span> <span class="dv">100</span><span class="op">;</span> Niter <span class="op">=</span> <span class="dv">70</span><span class="op">;</span> V <span class="op">=</span> zeros((Nmax, Nmax), <span class="bu">float</span>)          <span class="co"># float maybe Float</span></span>
<span id="cb44-10"><a href="scientific.html#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="scientific.html#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Working hard, wait for the figure while I count to 60&quot;</span>)</span>
<span id="cb44-12"><a href="scientific.html#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, Nmax<span class="op">-</span><span class="dv">1</span>):  V[k,<span class="dv">0</span>] <span class="op">=</span> <span class="fl">100.0</span>                      <span class="co"># line at 100V</span></span>
<span id="cb44-13"><a href="scientific.html#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="scientific.html#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(Niter):                                       <span class="co"># iterations over algorithm</span></span>
<span id="cb44-15"><a href="scientific.html#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">iter</span><span class="op">%</span><span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>: <span class="bu">print</span>( <span class="bu">iter</span>)</span>
<span id="cb44-16"><a href="scientific.html#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, Nmax<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb44-17"><a href="scientific.html#cb44-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,Nmax<span class="op">-</span><span class="dv">2</span>): V[i,j] <span class="op">=</span> <span class="fl">0.25</span> <span class="op">*</span> (V[i<span class="op">+</span><span class="dv">1</span>,j] <span class="op">+</span> V[i<span class="op">-</span><span class="dv">1</span>,j] <span class="op">+</span> V[i,j<span class="op">+</span><span class="dv">1</span>] <span class="op">+</span> V[i,j<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb44-18"><a href="scientific.html#cb44-18" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, Nmax<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>)<span class="op">;</span> y <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">2</span>)               <span class="co"># plot every other point</span></span>
<span id="cb44-19"><a href="scientific.html#cb44-19" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> p.meshgrid(x,y)</span>
<span id="cb44-20"><a href="scientific.html#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="scientific.html#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> functz(V):                                        <span class="co"># Function returns V(x, y)</span></span>
<span id="cb44-22"><a href="scientific.html#cb44-22" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> V[X,Y]</span>
<span id="cb44-23"><a href="scientific.html#cb44-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> z</span>
<span id="cb44-24"><a href="scientific.html#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="scientific.html#cb44-25" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> functz(V)</span>
<span id="cb44-26"><a href="scientific.html#cb44-26" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> p.figure()                                       <span class="co"># Create figures</span></span>
<span id="cb44-27"><a href="scientific.html#cb44-27" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> Axes3D(fig)                                       <span class="co"># plot axe</span></span>
<span id="cb44-28"><a href="scientific.html#cb44-28" aria-hidden="true" tabindex="-1"></a>ax.plot_wireframe(X, Y, Z, color <span class="op">=</span> <span class="st">&#39;r&#39;</span>)                <span class="co"># red wireframe</span></span>
<span id="cb44-29"><a href="scientific.html#cb44-29" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;X&#39;</span>)                                     <span class="co"># label axes</span></span>
<span id="cb44-30"><a href="scientific.html#cb44-30" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Y&#39;</span>)</span>
<span id="cb44-31"><a href="scientific.html#cb44-31" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">&#39;Potential&#39;</span>)</span>
<span id="cb44-32"><a href="scientific.html#cb44-32" aria-hidden="true" tabindex="-1"></a>p.show()                                               <span class="co"># display fig, close shell to quit</span></span></code></pre></div>
<p><img src="05-scientific_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="eigenvalue-problems" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Eigenvalue problems</h2>
<ul>
<li><code>lobpcg</code> (Locally Optimal Block Preconditioned Conjugate Gradient Method) * works very well in combination with <code>PyAMG</code> (example by Nathan Bell)</li>
</ul>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="scientific.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># http://scipy-lectures.org/_downloads/ScipyLectures-simple.pdf</span></span>
<span id="cb45-2"><a href="scientific.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Page 348</span></span>
<span id="cb45-3"><a href="scientific.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute eigenvectors and eigenvalues using a preconditioned eigensolver</span></span>
<span id="cb45-4"><a href="scientific.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ========================================================================</span></span>
<span id="cb45-5"><a href="scientific.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># In this example Smoothed Aggregation (SA) is used to precondition</span></span>
<span id="cb45-6"><a href="scientific.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the LOBPCG eigensolver on a two-dimensional Poisson problem with</span></span>
<span id="cb45-7"><a href="scientific.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dirichlet boundary conditions.</span></span>
<span id="cb45-8"><a href="scientific.html#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb45-9"><a href="scientific.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.sparse.linalg <span class="im">import</span> lobpcg</span>
<span id="cb45-10"><a href="scientific.html#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb45-11"><a href="scientific.html#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyamg <span class="im">import</span> smoothed_aggregation_solver</span>
<span id="cb45-12"><a href="scientific.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyamg.gallery <span class="im">import</span> poisson</span>
<span id="cb45-13"><a href="scientific.html#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="scientific.html#cb45-14" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb45-15"><a href="scientific.html#cb45-15" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb45-16"><a href="scientific.html#cb45-16" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> poisson((N,N), <span class="bu">format</span><span class="op">=</span><span class="st">&#39;csr&#39;</span>)</span>
<span id="cb45-17"><a href="scientific.html#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># create the AMG hierarchy</span></span>
<span id="cb45-18"><a href="scientific.html#cb45-18" aria-hidden="true" tabindex="-1"></a>ml <span class="op">=</span> smoothed_aggregation_solver(A)</span>
<span id="cb45-19"><a href="scientific.html#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co"># initial approximation to the K eigenvectors</span></span>
<span id="cb45-20"><a href="scientific.html#cb45-20" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scipy.rand(A.shape[<span class="dv">0</span>], K)</span>
<span id="cb45-21"><a href="scientific.html#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co"># preconditioner based on ml</span></span>
<span id="cb45-22"><a href="scientific.html#cb45-22" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> ml.aspreconditioner()</span>
<span id="cb45-23"><a href="scientific.html#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="co"># compute eigenvalues and eigenvectors with LOBPCG</span></span>
<span id="cb45-24"><a href="scientific.html#cb45-24" aria-hidden="true" tabindex="-1"></a>W,V <span class="op">=</span> lobpcg(A, X, M<span class="op">=</span>M, tol<span class="op">=</span><span class="fl">1e-8</span>, largest<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb45-25"><a href="scientific.html#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-26"><a href="scientific.html#cb45-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">9</span>))</span>
<span id="cb45-27"><a href="scientific.html#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate through the subplots adding data points</span></span>
<span id="cb45-28"><a href="scientific.html#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(K):</span>
<span id="cb45-29"><a href="scientific.html#cb45-29" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb45-30"><a href="scientific.html#cb45-30" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Eigenvector</span><span class="sc">%d</span><span class="st">&#39;</span><span class="op">%</span> i)</span>
<span id="cb45-31"><a href="scientific.html#cb45-31" aria-hidden="true" tabindex="-1"></a>    plt.pcolor(V[:,i].reshape(N,N))</span>
<span id="cb45-32"><a href="scientific.html#cb45-32" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb45-33"><a href="scientific.html#cb45-33" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb45-34"><a href="scientific.html#cb45-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
</div>
<div id="computational-physics" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Computational Physics</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="scientific.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of the Lorenz Attractor based on Edward Lorenz&#39;s 1963 &quot;Deterministic</span></span>
<span id="cb46-2"><a href="scientific.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nonperiodic Flow&quot; publication.</span></span>
<span id="cb46-3"><a href="scientific.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># http://journals.ametsoc.org/doi/abs/10.1175/1520-0469%281963%29020%3C0130%3ADNF%3E2.0.CO%3B2</span></span>
<span id="cb46-4"><a href="scientific.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb46-5"><a href="scientific.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb46-6"><a href="scientific.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb46-7"><a href="scientific.html#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="scientific.html#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="scientific.html#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lorenz(x, y, z, s<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">28</span>, b<span class="op">=</span><span class="fl">2.667</span>):</span>
<span id="cb46-10"><a href="scientific.html#cb46-10" aria-hidden="true" tabindex="-1"></a>    x_dot <span class="op">=</span> s<span class="op">*</span>(y <span class="op">-</span> x)</span>
<span id="cb46-11"><a href="scientific.html#cb46-11" aria-hidden="true" tabindex="-1"></a>    y_dot <span class="op">=</span> r<span class="op">*</span>x <span class="op">-</span> y <span class="op">-</span> x<span class="op">*</span>z</span>
<span id="cb46-12"><a href="scientific.html#cb46-12" aria-hidden="true" tabindex="-1"></a>    z_dot <span class="op">=</span> x<span class="op">*</span>y <span class="op">-</span> b<span class="op">*</span>z</span>
<span id="cb46-13"><a href="scientific.html#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x_dot, y_dot, z_dot</span>
<span id="cb46-14"><a href="scientific.html#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb46-15"><a href="scientific.html#cb46-15" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb46-16"><a href="scientific.html#cb46-16" aria-hidden="true" tabindex="-1"></a>stepCnt <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb46-17"><a href="scientific.html#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Need one more for the initial values</span></span>
<span id="cb46-18"><a href="scientific.html#cb46-18" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.empty((stepCnt <span class="op">+</span> <span class="dv">1</span>,))</span>
<span id="cb46-19"><a href="scientific.html#cb46-19" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.empty((stepCnt <span class="op">+</span> <span class="dv">1</span>,))</span>
<span id="cb46-20"><a href="scientific.html#cb46-20" aria-hidden="true" tabindex="-1"></a>zs <span class="op">=</span> np.empty((stepCnt <span class="op">+</span> <span class="dv">1</span>,))</span>
<span id="cb46-21"><a href="scientific.html#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting initial values</span></span>
<span id="cb46-22"><a href="scientific.html#cb46-22" aria-hidden="true" tabindex="-1"></a>xs[<span class="dv">0</span>], ys[<span class="dv">0</span>], zs[<span class="dv">0</span>] <span class="op">=</span> (<span class="fl">0.</span>, <span class="fl">1.</span>, <span class="fl">1.05</span>)</span>
<span id="cb46-23"><a href="scientific.html#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Stepping through &quot;time&quot;.</span></span>
<span id="cb46-24"><a href="scientific.html#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(stepCnt):</span>
<span id="cb46-25"><a href="scientific.html#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Derivatives of the X, Y, Z state</span></span>
<span id="cb46-26"><a href="scientific.html#cb46-26" aria-hidden="true" tabindex="-1"></a>    x_dot, y_dot, z_dot <span class="op">=</span> lorenz(xs[i], ys[i], zs[i])</span>
<span id="cb46-27"><a href="scientific.html#cb46-27" aria-hidden="true" tabindex="-1"></a>    xs[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> xs[i] <span class="op">+</span> (x_dot <span class="op">*</span> dt)</span>
<span id="cb46-28"><a href="scientific.html#cb46-28" aria-hidden="true" tabindex="-1"></a>    ys[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> ys[i] <span class="op">+</span> (y_dot <span class="op">*</span> dt)</span>
<span id="cb46-29"><a href="scientific.html#cb46-29" aria-hidden="true" tabindex="-1"></a>    zs[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> zs[i] <span class="op">+</span> (z_dot <span class="op">*</span> dt)</span>
<span id="cb46-30"><a href="scientific.html#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="scientific.html#cb46-31" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb46-32"><a href="scientific.html#cb46-32" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.gca(projection<span class="op">=</span><span class="st">&#39;3d&#39;</span>)</span>
<span id="cb46-33"><a href="scientific.html#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="scientific.html#cb46-34" aria-hidden="true" tabindex="-1"></a>ax.plot(xs, ys, zs, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb46-35"><a href="scientific.html#cb46-35" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&quot;X Axis&quot;</span>)</span>
<span id="cb46-36"><a href="scientific.html#cb46-36" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&quot;Y Axis&quot;</span>)</span>
<span id="cb46-37"><a href="scientific.html#cb46-37" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">&quot;Z Axis&quot;</span>)</span>
<span id="cb46-38"><a href="scientific.html#cb46-38" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&quot;Lorenz Attractor&quot;</span>)</span>
<span id="cb46-39"><a href="scientific.html#cb46-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-40"><a href="scientific.html#cb46-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="scientific.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/images_contours_and_fields/contour_image.html#sphx-glr-gallery-images-contours-and-fields-contour-image-py</span></span>
<span id="cb47-2"><a href="scientific.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb47-3"><a href="scientific.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb47-4"><a href="scientific.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span>
<span id="cb47-5"><a href="scientific.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Default delta is large because that makes it fast, and it illustrates</span></span>
<span id="cb47-6"><a href="scientific.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the correct registration between image and contours.</span></span>
<span id="cb47-7"><a href="scientific.html#cb47-7" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb47-8"><a href="scientific.html#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="scientific.html#cb47-9" aria-hidden="true" tabindex="-1"></a>extent <span class="op">=</span> (<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="op">-</span><span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb47-10"><a href="scientific.html#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="scientific.html#cb47-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">4.001</span>, delta)</span>
<span id="cb47-12"><a href="scientific.html#cb47-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">4.0</span>, <span class="fl">3.001</span>, delta)</span>
<span id="cb47-13"><a href="scientific.html#cb47-13" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb47-14"><a href="scientific.html#cb47-14" aria-hidden="true" tabindex="-1"></a>Z1 <span class="op">=</span> np.exp(<span class="op">-</span>X<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> Y<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb47-15"><a href="scientific.html#cb47-15" aria-hidden="true" tabindex="-1"></a>Z2 <span class="op">=</span> np.exp(<span class="op">-</span>(X <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> (Y <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb47-16"><a href="scientific.html#cb47-16" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> (Z1 <span class="op">-</span> Z2) <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb47-17"><a href="scientific.html#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="scientific.html#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Boost the upper limit to avoid truncation errors.</span></span>
<span id="cb47-19"><a href="scientific.html#cb47-19" aria-hidden="true" tabindex="-1"></a>levels <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">1.601</span>, <span class="fl">0.4</span>)</span>
<span id="cb47-20"><a href="scientific.html#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="scientific.html#cb47-21" aria-hidden="true" tabindex="-1"></a>norm <span class="op">=</span> cm.colors.Normalize(vmax<span class="op">=</span><span class="bu">abs</span>(Z).<span class="bu">max</span>(), vmin<span class="op">=-</span><span class="bu">abs</span>(Z).<span class="bu">max</span>())</span>
<span id="cb47-22"><a href="scientific.html#cb47-22" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> cm.PRGn</span>
<span id="cb47-23"><a href="scientific.html#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="scientific.html#cb47-24" aria-hidden="true" tabindex="-1"></a>fig, _axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb47-25"><a href="scientific.html#cb47-25" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb47-26"><a href="scientific.html#cb47-26" aria-hidden="true" tabindex="-1"></a>axs <span class="op">=</span> _axs.flatten()</span>
<span id="cb47-27"><a href="scientific.html#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="scientific.html#cb47-28" aria-hidden="true" tabindex="-1"></a>cset1 <span class="op">=</span> axs[<span class="dv">0</span>].contourf(X, Y, Z, levels, norm<span class="op">=</span>norm,</span>
<span id="cb47-29"><a href="scientific.html#cb47-29" aria-hidden="true" tabindex="-1"></a>                     cmap<span class="op">=</span>cm.get_cmap(cmap, <span class="bu">len</span>(levels) <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb47-30"><a href="scientific.html#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="co"># It is not necessary, but for the colormap, we need only the</span></span>
<span id="cb47-31"><a href="scientific.html#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co"># number of levels minus 1.  To avoid discretization error, use</span></span>
<span id="cb47-32"><a href="scientific.html#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="co"># either this number or a large number such as the default (256).</span></span>
<span id="cb47-33"><a href="scientific.html#cb47-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-34"><a href="scientific.html#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="co"># If we want lines as well as filled regions, we need to call</span></span>
<span id="cb47-35"><a href="scientific.html#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="co"># contour separately; don&#39;t try to change the edgecolor or edgewidth</span></span>
<span id="cb47-36"><a href="scientific.html#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="co"># of the polygons in the collections returned by contourf.</span></span>
<span id="cb47-37"><a href="scientific.html#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Use levels output from previous call to guarantee they are the same.</span></span>
<span id="cb47-38"><a href="scientific.html#cb47-38" aria-hidden="true" tabindex="-1"></a>cset2 <span class="op">=</span> axs[<span class="dv">0</span>].contour(X, Y, Z, cset1.levels, colors<span class="op">=</span><span class="st">&#39;k&#39;</span>)</span>
<span id="cb47-39"><a href="scientific.html#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="scientific.html#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="co"># We don&#39;t really need dashed contour lines to indicate negative</span></span>
<span id="cb47-41"><a href="scientific.html#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="co"># regions, so let&#39;s turn them off.</span></span>
<span id="cb47-42"><a href="scientific.html#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> cset2.collections:</span>
<span id="cb47-43"><a href="scientific.html#cb47-43" aria-hidden="true" tabindex="-1"></a>    c.set_linestyle(<span class="st">&#39;solid&#39;</span>)</span>
<span id="cb47-44"><a href="scientific.html#cb47-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-45"><a href="scientific.html#cb47-45" aria-hidden="true" tabindex="-1"></a><span class="co"># It is easier here to make a separate call to contour than</span></span>
<span id="cb47-46"><a href="scientific.html#cb47-46" aria-hidden="true" tabindex="-1"></a><span class="co"># to set up an array of colors and linewidths.</span></span>
<span id="cb47-47"><a href="scientific.html#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="co"># We are making a thick green line as a zero contour.</span></span>
<span id="cb47-48"><a href="scientific.html#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the zero level as a tuple with only 0 in it.</span></span>
<span id="cb47-49"><a href="scientific.html#cb47-49" aria-hidden="true" tabindex="-1"></a>cset3 <span class="op">=</span> axs[<span class="dv">0</span>].contour(X, Y, Z, (<span class="dv">0</span>,), colors<span class="op">=</span><span class="st">&#39;g&#39;</span>, linewidths<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb47-50"><a href="scientific.html#cb47-50" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">&#39;Filled contours&#39;</span>)</span>
<span id="cb47-51"><a href="scientific.html#cb47-51" aria-hidden="true" tabindex="-1"></a>fig.colorbar(cset1, ax<span class="op">=</span>axs[<span class="dv">0</span>])</span>
<span id="cb47-52"><a href="scientific.html#cb47-52" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].imshow(Z, extent<span class="op">=</span>extent, cmap<span class="op">=</span>cmap, norm<span class="op">=</span>norm)</span>
<span id="cb47-53"><a href="scientific.html#cb47-53" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].contour(Z, levels, colors<span class="op">=</span><span class="st">&#39;k&#39;</span>, origin<span class="op">=</span><span class="st">&#39;upper&#39;</span>, extent<span class="op">=</span>extent)</span>
<span id="cb47-54"><a href="scientific.html#cb47-54" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">&quot;Image, origin &#39;upper&#39;&quot;</span>)</span>
<span id="cb47-55"><a href="scientific.html#cb47-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-56"><a href="scientific.html#cb47-56" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].imshow(Z, origin<span class="op">=</span><span class="st">&#39;lower&#39;</span>, extent<span class="op">=</span>extent, cmap<span class="op">=</span>cmap, norm<span class="op">=</span>norm)</span>
<span id="cb47-57"><a href="scientific.html#cb47-57" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].contour(Z, levels, colors<span class="op">=</span><span class="st">&#39;k&#39;</span>, origin<span class="op">=</span><span class="st">&#39;lower&#39;</span>, extent<span class="op">=</span>extent)</span>
<span id="cb47-58"><a href="scientific.html#cb47-58" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">&quot;Image, origin &#39;lower&#39;&quot;</span>)</span>
<span id="cb47-59"><a href="scientific.html#cb47-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-60"><a href="scientific.html#cb47-60" aria-hidden="true" tabindex="-1"></a><span class="co"># We will use the interpolation &quot;nearest&quot; here to show the actual</span></span>
<span id="cb47-61"><a href="scientific.html#cb47-61" aria-hidden="true" tabindex="-1"></a><span class="co"># image pixels.</span></span>
<span id="cb47-62"><a href="scientific.html#cb47-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that the contour lines don&#39;t extend to the edge of the box.</span></span>
<span id="cb47-63"><a href="scientific.html#cb47-63" aria-hidden="true" tabindex="-1"></a><span class="co"># This is intentional. The Z values are defined at the center of each</span></span>
<span id="cb47-64"><a href="scientific.html#cb47-64" aria-hidden="true" tabindex="-1"></a><span class="co"># image pixel (each color block on the following subplot), so the</span></span>
<span id="cb47-65"><a href="scientific.html#cb47-65" aria-hidden="true" tabindex="-1"></a><span class="co"># domain that is contoured does not extend beyond these pixel centers.</span></span>
<span id="cb47-66"><a href="scientific.html#cb47-66" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> axs[<span class="dv">3</span>].imshow(Z, interpolation<span class="op">=</span><span class="st">&#39;nearest&#39;</span>, extent<span class="op">=</span>extent,</span>
<span id="cb47-67"><a href="scientific.html#cb47-67" aria-hidden="true" tabindex="-1"></a>                cmap<span class="op">=</span>cmap, norm<span class="op">=</span>norm)</span>
<span id="cb47-68"><a href="scientific.html#cb47-68" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].contour(Z, levels, colors<span class="op">=</span><span class="st">&#39;k&#39;</span>, origin<span class="op">=</span><span class="st">&#39;image&#39;</span>, extent<span class="op">=</span>extent)</span>
<span id="cb47-69"><a href="scientific.html#cb47-69" aria-hidden="true" tabindex="-1"></a>ylim <span class="op">=</span> axs[<span class="dv">3</span>].get_ylim()</span>
<span id="cb47-70"><a href="scientific.html#cb47-70" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].set_ylim(ylim[::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb47-71"><a href="scientific.html#cb47-71" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].set_title(<span class="st">&quot;Origin from rc, reversed y-axis&quot;</span>)</span>
<span id="cb47-72"><a href="scientific.html#cb47-72" aria-hidden="true" tabindex="-1"></a>fig.colorbar(im, ax<span class="op">=</span>axs[<span class="dv">3</span>])</span>
<span id="cb47-73"><a href="scientific.html#cb47-73" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb47-74"><a href="scientific.html#cb47-74" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="scientific.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/images_contours_and_fields/irregulardatagrid.html#sphx-glr-gallery-images-contours-and-fields-irregulardatagrid-py</span></span>
<span id="cb48-2"><a href="scientific.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb48-3"><a href="scientific.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.tri <span class="im">as</span> tri</span>
<span id="cb48-4"><a href="scientific.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb48-5"><a href="scientific.html#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="scientific.html#cb48-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">19680801</span>)</span>
<span id="cb48-7"><a href="scientific.html#cb48-7" aria-hidden="true" tabindex="-1"></a>npts <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb48-8"><a href="scientific.html#cb48-8" aria-hidden="true" tabindex="-1"></a>ngridx <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb48-9"><a href="scientific.html#cb48-9" aria-hidden="true" tabindex="-1"></a>ngridy <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb48-10"><a href="scientific.html#cb48-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, npts)</span>
<span id="cb48-11"><a href="scientific.html#cb48-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, npts)</span>
<span id="cb48-12"><a href="scientific.html#cb48-12" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> x <span class="op">*</span> np.exp(<span class="op">-</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> y<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb48-13"><a href="scientific.html#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="scientific.html#cb48-14" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb48-15"><a href="scientific.html#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="scientific.html#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------</span></span>
<span id="cb48-17"><a href="scientific.html#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpolation on a grid</span></span>
<span id="cb48-18"><a href="scientific.html#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------</span></span>
<span id="cb48-19"><a href="scientific.html#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co"># A contour plot of irregularly spaced data coordinates</span></span>
<span id="cb48-20"><a href="scientific.html#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co"># via interpolation on a grid.</span></span>
<span id="cb48-21"><a href="scientific.html#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="scientific.html#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create grid values first.</span></span>
<span id="cb48-23"><a href="scientific.html#cb48-23" aria-hidden="true" tabindex="-1"></a>xi <span class="op">=</span> np.linspace(<span class="op">-</span><span class="fl">2.1</span>, <span class="fl">2.1</span>, ngridx)</span>
<span id="cb48-24"><a href="scientific.html#cb48-24" aria-hidden="true" tabindex="-1"></a>yi <span class="op">=</span> np.linspace(<span class="op">-</span><span class="fl">2.1</span>, <span class="fl">2.1</span>, ngridy)</span>
<span id="cb48-25"><a href="scientific.html#cb48-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-26"><a href="scientific.html#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear interpolation of the data (x,y)</span></span>
<span id="cb48-27"><a href="scientific.html#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="co"># on a grid defined by (xi,yi)</span></span>
<span id="cb48-28"><a href="scientific.html#cb48-28" aria-hidden="true" tabindex="-1"></a>triang <span class="op">=</span> tri.Triangulation(x, y)</span>
<span id="cb48-29"><a href="scientific.html#cb48-29" aria-hidden="true" tabindex="-1"></a>interpolator <span class="op">=</span> tri.LinearTriInterpolator(triang, z)</span>
<span id="cb48-30"><a href="scientific.html#cb48-30" aria-hidden="true" tabindex="-1"></a>Xi, Yi <span class="op">=</span> np.meshgrid(xi, yi)</span>
<span id="cb48-31"><a href="scientific.html#cb48-31" aria-hidden="true" tabindex="-1"></a>zi <span class="op">=</span> interpolator(Xi, Yi)</span>
<span id="cb48-32"><a href="scientific.html#cb48-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-33"><a href="scientific.html#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that scipy.interpolate provides means to interpolate data on a grid</span></span>
<span id="cb48-34"><a href="scientific.html#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="co"># as well. The following would be an alternative to the four lines above:</span></span>
<span id="cb48-35"><a href="scientific.html#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="co">#from scipy.interpolate import griddata</span></span>
<span id="cb48-36"><a href="scientific.html#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="co">#zi = griddata((x, y), z, (xi[None,:], yi[:,None]), method=&#39;linear&#39;)</span></span>
<span id="cb48-37"><a href="scientific.html#cb48-37" aria-hidden="true" tabindex="-1"></a>ax1.contour(xi, yi, zi, <span class="dv">14</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, colors<span class="op">=</span><span class="st">&#39;k&#39;</span>)</span>
<span id="cb48-38"><a href="scientific.html#cb48-38" aria-hidden="true" tabindex="-1"></a>cntr1 <span class="op">=</span> ax1.contourf(xi, yi, zi, <span class="dv">14</span>, cmap<span class="op">=</span><span class="st">&quot;RdBu_r&quot;</span>)</span>
<span id="cb48-39"><a href="scientific.html#cb48-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-40"><a href="scientific.html#cb48-40" aria-hidden="true" tabindex="-1"></a>fig.colorbar(cntr1, ax<span class="op">=</span>ax1)</span>
<span id="cb48-41"><a href="scientific.html#cb48-41" aria-hidden="true" tabindex="-1"></a>ax1.plot(x, y, <span class="st">&#39;ko&#39;</span>, ms<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb48-42"><a href="scientific.html#cb48-42" aria-hidden="true" tabindex="-1"></a>ax1.axis((<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb48-43"><a href="scientific.html#cb48-43" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;grid and contour (</span><span class="sc">%d</span><span class="st"> points, </span><span class="sc">%d</span><span class="st"> grid points)&#39;</span> <span class="op">%</span></span>
<span id="cb48-44"><a href="scientific.html#cb48-44" aria-hidden="true" tabindex="-1"></a>              (npts, ngridx <span class="op">*</span> ngridy))</span>
<span id="cb48-45"><a href="scientific.html#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------</span></span>
<span id="cb48-46"><a href="scientific.html#cb48-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Tricontour</span></span>
<span id="cb48-47"><a href="scientific.html#cb48-47" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------</span></span>
<span id="cb48-48"><a href="scientific.html#cb48-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Directly supply the unordered, irregularly spaced coordinates</span></span>
<span id="cb48-49"><a href="scientific.html#cb48-49" aria-hidden="true" tabindex="-1"></a><span class="co"># to tricontour.</span></span>
<span id="cb48-50"><a href="scientific.html#cb48-50" aria-hidden="true" tabindex="-1"></a>ax2.tricontour(x, y, z, <span class="dv">14</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, colors<span class="op">=</span><span class="st">&#39;k&#39;</span>)</span>
<span id="cb48-51"><a href="scientific.html#cb48-51" aria-hidden="true" tabindex="-1"></a>cntr2 <span class="op">=</span> ax2.tricontourf(x, y, z, <span class="dv">14</span>, cmap<span class="op">=</span><span class="st">&quot;RdBu_r&quot;</span>)</span>
<span id="cb48-52"><a href="scientific.html#cb48-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-53"><a href="scientific.html#cb48-53" aria-hidden="true" tabindex="-1"></a>fig.colorbar(cntr2, ax<span class="op">=</span>ax2)</span>
<span id="cb48-54"><a href="scientific.html#cb48-54" aria-hidden="true" tabindex="-1"></a>ax2.plot(x, y, <span class="st">&#39;ko&#39;</span>, ms<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb48-55"><a href="scientific.html#cb48-55" aria-hidden="true" tabindex="-1"></a>ax2.axis((<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb48-56"><a href="scientific.html#cb48-56" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;tricontour (</span><span class="sc">%d</span><span class="st"> points)&#39;</span> <span class="op">%</span> npts)</span>
<span id="cb48-57"><a href="scientific.html#cb48-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-58"><a href="scientific.html#cb48-58" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb48-59"><a href="scientific.html#cb48-59" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
</div>
<div id="triangulation-and-delauney-maps" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Triangulation and Delauney maps</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="scientific.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.tri <span class="im">import</span> Triangulation, TriAnalyzer, UniformTriRefiner</span>
<span id="cb49-2"><a href="scientific.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb49-3"><a href="scientific.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb49-4"><a href="scientific.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb49-5"><a href="scientific.html#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb49-6"><a href="scientific.html#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Analytical test function</span></span>
<span id="cb49-7"><a href="scientific.html#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb49-8"><a href="scientific.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> experiment_res(x, y):</span>
<span id="cb49-9"><a href="scientific.html#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot; An analytic function representing experiment results &quot;&quot;&quot;</span></span>
<span id="cb49-10"><a href="scientific.html#cb49-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fl">2.</span> <span class="op">*</span> x</span>
<span id="cb49-11"><a href="scientific.html#cb49-11" aria-hidden="true" tabindex="-1"></a>    r1 <span class="op">=</span> np.sqrt((<span class="fl">0.5</span> <span class="op">-</span> x)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (<span class="fl">0.5</span> <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb49-12"><a href="scientific.html#cb49-12" aria-hidden="true" tabindex="-1"></a>    theta1 <span class="op">=</span> np.arctan2(<span class="fl">0.5</span> <span class="op">-</span> x, <span class="fl">0.5</span> <span class="op">-</span> y)</span>
<span id="cb49-13"><a href="scientific.html#cb49-13" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> np.sqrt((<span class="op">-</span>x <span class="op">-</span> <span class="fl">0.2</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (<span class="op">-</span>y <span class="op">-</span> <span class="fl">0.2</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb49-14"><a href="scientific.html#cb49-14" aria-hidden="true" tabindex="-1"></a>    theta2 <span class="op">=</span> np.arctan2(<span class="op">-</span>x <span class="op">-</span> <span class="fl">0.2</span>, <span class="op">-</span>y <span class="op">-</span> <span class="fl">0.2</span>)</span>
<span id="cb49-15"><a href="scientific.html#cb49-15" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> (<span class="dv">4</span> <span class="op">*</span> (np.exp((r1 <span class="op">/</span> <span class="dv">10</span>)<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="fl">30.</span> <span class="op">*</span> np.cos(<span class="dv">3</span> <span class="op">*</span> theta1) <span class="op">+</span></span>
<span id="cb49-16"><a href="scientific.html#cb49-16" aria-hidden="true" tabindex="-1"></a>         (np.exp((r2 <span class="op">/</span> <span class="dv">10</span>)<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="fl">30.</span> <span class="op">*</span> np.cos(<span class="dv">5</span> <span class="op">*</span> theta2) <span class="op">+</span></span>
<span id="cb49-17"><a href="scientific.html#cb49-17" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2</span> <span class="op">*</span> (x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb49-18"><a href="scientific.html#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (np.<span class="bu">max</span>(z) <span class="op">-</span> z) <span class="op">/</span> (np.<span class="bu">max</span>(z) <span class="op">-</span> np.<span class="bu">min</span>(z))</span>
<span id="cb49-19"><a href="scientific.html#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="scientific.html#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb49-21"><a href="scientific.html#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating the initial data test points and triangulation for the demo</span></span>
<span id="cb49-22"><a href="scientific.html#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb49-23"><a href="scientific.html#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="co"># User parameters for data test points</span></span>
<span id="cb49-24"><a href="scientific.html#cb49-24" aria-hidden="true" tabindex="-1"></a>n_test <span class="op">=</span> <span class="dv">200</span>  <span class="co"># Number of test data points, tested from 3 to 5000 for subdiv=3</span></span>
<span id="cb49-25"><a href="scientific.html#cb49-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-26"><a href="scientific.html#cb49-26" aria-hidden="true" tabindex="-1"></a>subdiv <span class="op">=</span> <span class="dv">3</span>  <span class="co"># Number of recursive subdivisions of the initial mesh for smooth</span></span>
<span id="cb49-27"><a href="scientific.html#cb49-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># plots. Values &gt;3 might result in a very high number of triangles</span></span>
<span id="cb49-28"><a href="scientific.html#cb49-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># for the refine mesh: new triangles numbering = (4**subdiv)*ntri</span></span>
<span id="cb49-29"><a href="scientific.html#cb49-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-30"><a href="scientific.html#cb49-30" aria-hidden="true" tabindex="-1"></a>init_mask_frac <span class="op">=</span> <span class="fl">0.0</span>    <span class="co"># Float &gt; 0. adjusting the proportion of</span></span>
<span id="cb49-31"><a href="scientific.html#cb49-31" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># (invalid) initial triangles which will be masked</span></span>
<span id="cb49-32"><a href="scientific.html#cb49-32" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># out. Enter 0 for no mask.</span></span>
<span id="cb49-33"><a href="scientific.html#cb49-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-34"><a href="scientific.html#cb49-34" aria-hidden="true" tabindex="-1"></a>min_circle_ratio <span class="op">=</span> <span class="fl">.01</span>  <span class="co"># Minimum circle ratio - border triangles with circle</span></span>
<span id="cb49-35"><a href="scientific.html#cb49-35" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># ratio below this will be masked if they touch a</span></span>
<span id="cb49-36"><a href="scientific.html#cb49-36" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># border. Suggested value 0.01; use -1 to keep</span></span>
<span id="cb49-37"><a href="scientific.html#cb49-37" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># all triangles.</span></span>
<span id="cb49-38"><a href="scientific.html#cb49-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-39"><a href="scientific.html#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Random points</span></span>
<span id="cb49-40"><a href="scientific.html#cb49-40" aria-hidden="true" tabindex="-1"></a>random_gen <span class="op">=</span> np.random.RandomState(seed<span class="op">=</span><span class="dv">19680801</span>)</span>
<span id="cb49-41"><a href="scientific.html#cb49-41" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> random_gen.uniform(<span class="op">-</span><span class="fl">1.</span>, <span class="fl">1.</span>, size<span class="op">=</span>n_test)</span>
<span id="cb49-42"><a href="scientific.html#cb49-42" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> random_gen.uniform(<span class="op">-</span><span class="fl">1.</span>, <span class="fl">1.</span>, size<span class="op">=</span>n_test)</span>
<span id="cb49-43"><a href="scientific.html#cb49-43" aria-hidden="true" tabindex="-1"></a>z_test <span class="op">=</span> experiment_res(x_test, y_test)</span>
<span id="cb49-44"><a href="scientific.html#cb49-44" aria-hidden="true" tabindex="-1"></a><span class="co"># meshing with Delaunay triangulation</span></span>
<span id="cb49-45"><a href="scientific.html#cb49-45" aria-hidden="true" tabindex="-1"></a>tri <span class="op">=</span> Triangulation(x_test, y_test)</span>
<span id="cb49-46"><a href="scientific.html#cb49-46" aria-hidden="true" tabindex="-1"></a>ntri <span class="op">=</span> tri.triangles.shape[<span class="dv">0</span>]</span>
<span id="cb49-47"><a href="scientific.html#cb49-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Some invalid data are masked out</span></span>
<span id="cb49-48"><a href="scientific.html#cb49-48" aria-hidden="true" tabindex="-1"></a>mask_init <span class="op">=</span> np.zeros(ntri, dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb49-49"><a href="scientific.html#cb49-49" aria-hidden="true" tabindex="-1"></a>masked_tri <span class="op">=</span> random_gen.randint(<span class="dv">0</span>, ntri, <span class="bu">int</span>(ntri <span class="op">*</span> init_mask_frac))</span>
<span id="cb49-50"><a href="scientific.html#cb49-50" aria-hidden="true" tabindex="-1"></a>mask_init[masked_tri] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb49-51"><a href="scientific.html#cb49-51" aria-hidden="true" tabindex="-1"></a>tri.set_mask(mask_init)</span>
<span id="cb49-52"><a href="scientific.html#cb49-52" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb49-53"><a href="scientific.html#cb49-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Improving the triangulation before high-res plots: removing flat triangles</span></span>
<span id="cb49-54"><a href="scientific.html#cb49-54" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb49-55"><a href="scientific.html#cb49-55" aria-hidden="true" tabindex="-1"></a><span class="co"># masking badly shaped triangles at the border of the triangular mesh.</span></span>
<span id="cb49-56"><a href="scientific.html#cb49-56" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> TriAnalyzer(tri).get_flat_tri_mask(min_circle_ratio)</span>
<span id="cb49-57"><a href="scientific.html#cb49-57" aria-hidden="true" tabindex="-1"></a>tri.set_mask(mask)</span>
<span id="cb49-58"><a href="scientific.html#cb49-58" aria-hidden="true" tabindex="-1"></a><span class="co"># refining the data</span></span>
<span id="cb49-59"><a href="scientific.html#cb49-59" aria-hidden="true" tabindex="-1"></a>refiner <span class="op">=</span> UniformTriRefiner(tri)</span>
<span id="cb49-60"><a href="scientific.html#cb49-60" aria-hidden="true" tabindex="-1"></a>tri_refi, z_test_refi <span class="op">=</span> refiner.refine_field(z_test, subdiv<span class="op">=</span>subdiv)</span>
<span id="cb49-61"><a href="scientific.html#cb49-61" aria-hidden="true" tabindex="-1"></a><span class="co"># analytical &#39;results&#39; for comparison</span></span>
<span id="cb49-62"><a href="scientific.html#cb49-62" aria-hidden="true" tabindex="-1"></a>z_expected <span class="op">=</span> experiment_res(tri_refi.x, tri_refi.y)</span>
<span id="cb49-63"><a href="scientific.html#cb49-63" aria-hidden="true" tabindex="-1"></a><span class="co"># for the demo: loading the &#39;flat&#39; triangles for plot</span></span>
<span id="cb49-64"><a href="scientific.html#cb49-64" aria-hidden="true" tabindex="-1"></a>flat_tri <span class="op">=</span> Triangulation(x_test, y_test)</span>
<span id="cb49-65"><a href="scientific.html#cb49-65" aria-hidden="true" tabindex="-1"></a>flat_tri.set_mask(<span class="op">~</span>mask)</span>
<span id="cb49-66"><a href="scientific.html#cb49-66" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb49-67"><a href="scientific.html#cb49-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Now the plots</span></span>
<span id="cb49-68"><a href="scientific.html#cb49-68" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb49-69"><a href="scientific.html#cb49-69" aria-hidden="true" tabindex="-1"></a><span class="co"># User options for plots</span></span>
<span id="cb49-70"><a href="scientific.html#cb49-70" aria-hidden="true" tabindex="-1"></a>plot_tri <span class="op">=</span> <span class="va">True</span>          <span class="co"># plot of base triangulation</span></span>
<span id="cb49-71"><a href="scientific.html#cb49-71" aria-hidden="true" tabindex="-1"></a>plot_masked_tri <span class="op">=</span> <span class="va">True</span>   <span class="co"># plot of excessively flat excluded triangles</span></span>
<span id="cb49-72"><a href="scientific.html#cb49-72" aria-hidden="true" tabindex="-1"></a>plot_refi_tri <span class="op">=</span> <span class="va">False</span>    <span class="co"># plot of refined triangulation</span></span>
<span id="cb49-73"><a href="scientific.html#cb49-73" aria-hidden="true" tabindex="-1"></a>plot_expected <span class="op">=</span> <span class="va">False</span>    <span class="co"># plot of analytical function values for comparison</span></span>
<span id="cb49-74"><a href="scientific.html#cb49-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-75"><a href="scientific.html#cb49-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphical options for tricontouring</span></span>
<span id="cb49-76"><a href="scientific.html#cb49-76" aria-hidden="true" tabindex="-1"></a>levels <span class="op">=</span> np.arange(<span class="fl">0.</span>, <span class="fl">1.</span>, <span class="fl">0.025</span>)</span>
<span id="cb49-77"><a href="scientific.html#cb49-77" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> cm.get_cmap(name<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, lut<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb49-78"><a href="scientific.html#cb49-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-79"><a href="scientific.html#cb49-79" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb49-80"><a href="scientific.html#cb49-80" aria-hidden="true" tabindex="-1"></a>ax.set_aspect(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb49-81"><a href="scientific.html#cb49-81" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&quot;Filtering a Delaunay mesh</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span></span>
<span id="cb49-82"><a href="scientific.html#cb49-82" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;(application to high-resolution tricontouring)&quot;</span>)</span>
<span id="cb49-83"><a href="scientific.html#cb49-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-84"><a href="scientific.html#cb49-84" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) plot of the refined (computed) data contours:</span></span>
<span id="cb49-85"><a href="scientific.html#cb49-85" aria-hidden="true" tabindex="-1"></a>ax.tricontour(tri_refi, z_test_refi, levels<span class="op">=</span>levels, cmap<span class="op">=</span>cmap,</span>
<span id="cb49-86"><a href="scientific.html#cb49-86" aria-hidden="true" tabindex="-1"></a>               linewidths<span class="op">=</span>[<span class="fl">2.0</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>])</span>
<span id="cb49-87"><a href="scientific.html#cb49-87" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) plot of the expected (analytical) data contours (dashed):</span></span>
<span id="cb49-88"><a href="scientific.html#cb49-88" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> plot_expected:</span>
<span id="cb49-89"><a href="scientific.html#cb49-89" aria-hidden="true" tabindex="-1"></a>    ax.tricontour(tri_refi, z_expected, levels<span class="op">=</span>levels, cmap<span class="op">=</span>cmap,</span>
<span id="cb49-90"><a href="scientific.html#cb49-90" aria-hidden="true" tabindex="-1"></a>                   linestyles<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb49-91"><a href="scientific.html#cb49-91" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) plot of the fine mesh on which interpolation was done:</span></span>
<span id="cb49-92"><a href="scientific.html#cb49-92" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> plot_refi_tri:</span>
<span id="cb49-93"><a href="scientific.html#cb49-93" aria-hidden="true" tabindex="-1"></a>    ax.triplot(tri_refi, color<span class="op">=</span><span class="st">&#39;0.97&#39;</span>)</span>
<span id="cb49-94"><a href="scientific.html#cb49-94" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) plot of the initial &#39;coarse&#39; mesh:</span></span>
<span id="cb49-95"><a href="scientific.html#cb49-95" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> plot_tri:</span>
<span id="cb49-96"><a href="scientific.html#cb49-96" aria-hidden="true" tabindex="-1"></a>    ax.triplot(tri, color<span class="op">=</span><span class="st">&#39;0.7&#39;</span>)</span>
<span id="cb49-97"><a href="scientific.html#cb49-97" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) plot of the unvalidated triangles from naive Delaunay Triangulation:</span></span>
<span id="cb49-98"><a href="scientific.html#cb49-98" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> plot_masked_tri:</span>
<span id="cb49-99"><a href="scientific.html#cb49-99" aria-hidden="true" tabindex="-1"></a>    ax.triplot(flat_tri, color<span class="op">=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb49-100"><a href="scientific.html#cb49-100" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="scientific.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/images_contours_and_fields/triinterp_demo.html#sphx-glr-gallery-images-contours-and-fields-triinterp-demo-py</span></span>
<span id="cb50-2"><a href="scientific.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb50-3"><a href="scientific.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.tri <span class="im">as</span> mtri</span>
<span id="cb50-4"><a href="scientific.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb50-5"><a href="scientific.html#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="scientific.html#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create triangulation.</span></span>
<span id="cb50-7"><a href="scientific.html#cb50-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.asarray([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">1.5</span>])</span>
<span id="cb50-8"><a href="scientific.html#cb50-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.asarray([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">3.0</span>])</span>
<span id="cb50-9"><a href="scientific.html#cb50-9" aria-hidden="true" tabindex="-1"></a>triangles <span class="op">=</span> [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>], [<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">4</span>], [<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">5</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb50-10"><a href="scientific.html#cb50-10" aria-hidden="true" tabindex="-1"></a>             [<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>], [<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">7</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]]</span>
<span id="cb50-11"><a href="scientific.html#cb50-11" aria-hidden="true" tabindex="-1"></a>triang <span class="op">=</span> mtri.Triangulation(x, y, triangles)</span>
<span id="cb50-12"><a href="scientific.html#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="scientific.html#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpolate to regularly-spaced quad grid.</span></span>
<span id="cb50-14"><a href="scientific.html#cb50-14" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.cos(<span class="fl">1.5</span> <span class="op">*</span> x) <span class="op">*</span> np.cos(<span class="fl">1.5</span> <span class="op">*</span> y)</span>
<span id="cb50-15"><a href="scientific.html#cb50-15" aria-hidden="true" tabindex="-1"></a>xi, yi <span class="op">=</span> np.meshgrid(np.linspace(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">20</span>), np.linspace(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">20</span>))</span>
<span id="cb50-16"><a href="scientific.html#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="scientific.html#cb50-17" aria-hidden="true" tabindex="-1"></a>interp_lin <span class="op">=</span> mtri.LinearTriInterpolator(triang, z)</span>
<span id="cb50-18"><a href="scientific.html#cb50-18" aria-hidden="true" tabindex="-1"></a>zi_lin <span class="op">=</span> interp_lin(xi, yi)</span>
<span id="cb50-19"><a href="scientific.html#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="scientific.html#cb50-20" aria-hidden="true" tabindex="-1"></a>interp_cubic_geom <span class="op">=</span> mtri.CubicTriInterpolator(triang, z, kind<span class="op">=</span><span class="st">&#39;geom&#39;</span>)</span>
<span id="cb50-21"><a href="scientific.html#cb50-21" aria-hidden="true" tabindex="-1"></a>zi_cubic_geom <span class="op">=</span> interp_cubic_geom(xi, yi)</span>
<span id="cb50-22"><a href="scientific.html#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="scientific.html#cb50-23" aria-hidden="true" tabindex="-1"></a>interp_cubic_min_E <span class="op">=</span> mtri.CubicTriInterpolator(triang, z, kind<span class="op">=</span><span class="st">&#39;min_E&#39;</span>)</span>
<span id="cb50-24"><a href="scientific.html#cb50-24" aria-hidden="true" tabindex="-1"></a>zi_cubic_min_E <span class="op">=</span> interp_cubic_min_E(xi, yi)</span>
<span id="cb50-25"><a href="scientific.html#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="scientific.html#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the figure</span></span>
<span id="cb50-27"><a href="scientific.html#cb50-27" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-28"><a href="scientific.html#cb50-28" aria-hidden="true" tabindex="-1"></a>axs <span class="op">=</span> axs.flatten()</span>
<span id="cb50-29"><a href="scientific.html#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-30"><a href="scientific.html#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the triangulation.</span></span>
<span id="cb50-31"><a href="scientific.html#cb50-31" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].tricontourf(triang, z)</span>
<span id="cb50-32"><a href="scientific.html#cb50-32" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].triplot(triang, <span class="st">&#39;ko-&#39;</span>)</span>
<span id="cb50-33"><a href="scientific.html#cb50-33" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">&#39;Triangular grid&#39;</span>)</span>
<span id="cb50-34"><a href="scientific.html#cb50-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-35"><a href="scientific.html#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot linear interpolation to quad grid.</span></span>
<span id="cb50-36"><a href="scientific.html#cb50-36" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].contourf(xi, yi, zi_lin)</span>
<span id="cb50-37"><a href="scientific.html#cb50-37" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(xi, yi, <span class="st">&#39;k-&#39;</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-38"><a href="scientific.html#cb50-38" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(xi.T, yi.T, <span class="st">&#39;k-&#39;</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-39"><a href="scientific.html#cb50-39" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">&quot;Linear interpolation&quot;</span>)</span>
<span id="cb50-40"><a href="scientific.html#cb50-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-41"><a href="scientific.html#cb50-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cubic interpolation to quad grid, kind=geom</span></span>
<span id="cb50-42"><a href="scientific.html#cb50-42" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].contourf(xi, yi, zi_cubic_geom)</span>
<span id="cb50-43"><a href="scientific.html#cb50-43" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(xi, yi, <span class="st">&#39;k-&#39;</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-44"><a href="scientific.html#cb50-44" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].plot(xi.T, yi.T, <span class="st">&#39;k-&#39;</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-45"><a href="scientific.html#cb50-45" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">&quot;Cubic interpolation,</span><span class="ch">\n</span><span class="st">kind=&#39;geom&#39;&quot;</span>)</span>
<span id="cb50-46"><a href="scientific.html#cb50-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-47"><a href="scientific.html#cb50-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cubic interpolation to quad grid, kind=min_E</span></span>
<span id="cb50-48"><a href="scientific.html#cb50-48" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].contourf(xi, yi, zi_cubic_min_E)</span>
<span id="cb50-49"><a href="scientific.html#cb50-49" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].plot(xi, yi, <span class="st">&#39;k-&#39;</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-50"><a href="scientific.html#cb50-50" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].plot(xi.T, yi.T, <span class="st">&#39;k-&#39;</span>, lw<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-51"><a href="scientific.html#cb50-51" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">3</span>].set_title(<span class="st">&quot;Cubic interpolation,</span><span class="ch">\n</span><span class="st">kind=&#39;min_E&#39;&quot;</span>)</span>
<span id="cb50-52"><a href="scientific.html#cb50-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-53"><a href="scientific.html#cb50-53" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb50-54"><a href="scientific.html#cb50-54" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
</div>
<div id="contour-maps" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Contour maps</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="scientific.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># http://www.scipy-lectures.org/intro/matplotlib/auto_examples/plot_contour_ex.html</span></span>
<span id="cb51-2"><a href="scientific.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb51-3"><a href="scientific.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-4"><a href="scientific.html#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="scientific.html#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="scientific.html#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x, y):</span>
<span id="cb51-7"><a href="scientific.html#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span> <span class="op">-</span> x <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> x <span class="op">**</span> <span class="dv">5</span> <span class="op">+</span> y <span class="op">**</span> <span class="dv">3</span>) <span class="op">*</span> np.exp(<span class="op">-</span>x <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span>y <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb51-8"><a href="scientific.html#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="scientific.html#cb51-9" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">256</span></span>
<span id="cb51-10"><a href="scientific.html#cb51-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, n)</span>
<span id="cb51-11"><a href="scientific.html#cb51-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, n)</span>
<span id="cb51-12"><a href="scientific.html#cb51-12" aria-hidden="true" tabindex="-1"></a>X,Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb51-13"><a href="scientific.html#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="scientific.html#cb51-14" aria-hidden="true" tabindex="-1"></a>plt.axes([<span class="fl">0.025</span>, <span class="fl">0.025</span>, <span class="fl">0.95</span>, <span class="fl">0.95</span>])</span>
<span id="cb51-15"><a href="scientific.html#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="scientific.html#cb51-16" aria-hidden="true" tabindex="-1"></a>plt.contourf(X, Y, f(X, Y), <span class="dv">8</span>, alpha<span class="op">=</span><span class="fl">.75</span>, cmap<span class="op">=</span>plt.cm.hot)</span>
<span id="cb51-17"><a href="scientific.html#cb51-17" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> plt.contour(X, Y, f(X, Y), <span class="dv">8</span>, colors<span class="op">=</span><span class="st">&#39;black&#39;</span>, linewidth<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb51-18"><a href="scientific.html#cb51-18" aria-hidden="true" tabindex="-1"></a>plt.clabel(C, inline<span class="op">=</span><span class="dv">1</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb51-19"><a href="scientific.html#cb51-19" aria-hidden="true" tabindex="-1"></a>plt.xticks(())</span>
<span id="cb51-20"><a href="scientific.html#cb51-20" aria-hidden="true" tabindex="-1"></a>plt.yticks(())</span>
<span id="cb51-21"><a href="scientific.html#cb51-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
</div>
<div id="real-time" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Real time</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="scientific.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/lines_bars_and_markers/cohere.html#sphx-glr-gallery-lines-bars-and-markers-cohere-py</span></span>
<span id="cb52-2"><a href="scientific.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb52-3"><a href="scientific.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb52-4"><a href="scientific.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixing random state for reproducibility</span></span>
<span id="cb52-5"><a href="scientific.html#cb52-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">19680801</span>)</span>
<span id="cb52-6"><a href="scientific.html#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="scientific.html#cb52-7" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb52-8"><a href="scientific.html#cb52-8" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">30</span>, dt)</span>
<span id="cb52-9"><a href="scientific.html#cb52-9" aria-hidden="true" tabindex="-1"></a>nse1 <span class="op">=</span> np.random.randn(<span class="bu">len</span>(t))                 <span class="co"># white noise 1</span></span>
<span id="cb52-10"><a href="scientific.html#cb52-10" aria-hidden="true" tabindex="-1"></a>nse2 <span class="op">=</span> np.random.randn(<span class="bu">len</span>(t))                 <span class="co"># white noise 2</span></span>
<span id="cb52-11"><a href="scientific.html#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="scientific.html#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Two signals with a coherent part at 10Hz and a random part</span></span>
<span id="cb52-13"><a href="scientific.html#cb52-13" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">=</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> <span class="dv">10</span> <span class="op">*</span> t) <span class="op">+</span> nse1</span>
<span id="cb52-14"><a href="scientific.html#cb52-14" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> <span class="dv">10</span> <span class="op">*</span> t) <span class="op">+</span> nse2</span>
<span id="cb52-15"><a href="scientific.html#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="scientific.html#cb52-16" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb52-17"><a href="scientific.html#cb52-17" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(t, s1, t, s2)</span>
<span id="cb52-18"><a href="scientific.html#cb52-18" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlim(<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb52-19"><a href="scientific.html#cb52-19" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">&#39;time&#39;</span>)</span>
<span id="cb52-20"><a href="scientific.html#cb52-20" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">&#39;s1 and s2&#39;</span>)</span>
<span id="cb52-21"><a href="scientific.html#cb52-21" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb52-22"><a href="scientific.html#cb52-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-23"><a href="scientific.html#cb52-23" aria-hidden="true" tabindex="-1"></a>cxy, f <span class="op">=</span> axs[<span class="dv">1</span>].cohere(s1, s2, <span class="dv">256</span>, <span class="fl">1.</span> <span class="op">/</span> dt)</span>
<span id="cb52-24"><a href="scientific.html#cb52-24" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">&#39;coherence&#39;</span>)</span>
<span id="cb52-25"><a href="scientific.html#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="scientific.html#cb52-26" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb52-27"><a href="scientific.html#cb52-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="scientific.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/scales/symlog_demo.html#sphx-glr-gallery-scales-symlog-demo-py</span></span>
<span id="cb53-2"><a href="scientific.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb53-3"><a href="scientific.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-4"><a href="scientific.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="scientific.html#cb53-5" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb53-6"><a href="scientific.html#cb53-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">50.0</span>, <span class="fl">50.0</span>, dt)</span>
<span id="cb53-7"><a href="scientific.html#cb53-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="fl">100.0</span>, dt)</span>
<span id="cb53-8"><a href="scientific.html#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="scientific.html#cb53-9" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">311</span>)</span>
<span id="cb53-10"><a href="scientific.html#cb53-10" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y)</span>
<span id="cb53-11"><a href="scientific.html#cb53-11" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">&#39;symlog&#39;</span>)</span>
<span id="cb53-12"><a href="scientific.html#cb53-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;symlogx&#39;</span>)</span>
<span id="cb53-13"><a href="scientific.html#cb53-13" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb53-14"><a href="scientific.html#cb53-14" aria-hidden="true" tabindex="-1"></a>plt.gca().xaxis.grid(<span class="va">True</span>, which<span class="op">=</span><span class="st">&#39;minor&#39;</span>)  <span class="co"># minor grid on too</span></span>
<span id="cb53-15"><a href="scientific.html#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="scientific.html#cb53-16" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">312</span>)</span>
<span id="cb53-17"><a href="scientific.html#cb53-17" aria-hidden="true" tabindex="-1"></a>plt.plot(y, x)</span>
<span id="cb53-18"><a href="scientific.html#cb53-18" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">&#39;symlog&#39;</span>)</span>
<span id="cb53-19"><a href="scientific.html#cb53-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;symlogy&#39;</span>)</span>
<span id="cb53-20"><a href="scientific.html#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="scientific.html#cb53-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">313</span>)</span>
<span id="cb53-22"><a href="scientific.html#cb53-22" aria-hidden="true" tabindex="-1"></a>plt.plot(x, np.sin(x <span class="op">/</span> <span class="fl">3.0</span>))</span>
<span id="cb53-23"><a href="scientific.html#cb53-23" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">&#39;symlog&#39;</span>)</span>
<span id="cb53-24"><a href="scientific.html#cb53-24" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">&#39;symlog&#39;</span>, linthreshy<span class="op">=</span><span class="fl">0.015</span>)</span>
<span id="cb53-25"><a href="scientific.html#cb53-25" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb53-26"><a href="scientific.html#cb53-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;symlog both&#39;</span>)</span>
<span id="cb53-27"><a href="scientific.html#cb53-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-28"><a href="scientific.html#cb53-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb53-29"><a href="scientific.html#cb53-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="scientific.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/gallery/lines_bars_and_markers/step_demo.html#sphx-glr-gallery-lines-bars-and-markers-step-demo-py</span></span>
<span id="cb54-2"><a href="scientific.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb54-3"><a href="scientific.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> ma</span>
<span id="cb54-4"><a href="scientific.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb54-5"><a href="scientific.html#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="scientific.html#cb54-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">7</span>, <span class="fl">0.4</span>)</span>
<span id="cb54-7"><a href="scientific.html#cb54-7" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.sin(x)</span>
<span id="cb54-8"><a href="scientific.html#cb54-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y0.copy() <span class="op">+</span> <span class="fl">2.5</span></span>
<span id="cb54-9"><a href="scientific.html#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="scientific.html#cb54-10" aria-hidden="true" tabindex="-1"></a>plt.step(x, y, label<span class="op">=</span><span class="st">&#39;pre (default)&#39;</span>)</span>
<span id="cb54-11"><a href="scientific.html#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="scientific.html#cb54-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">-=</span> <span class="fl">0.5</span></span>
<span id="cb54-13"><a href="scientific.html#cb54-13" aria-hidden="true" tabindex="-1"></a>plt.step(x, y, where<span class="op">=</span><span class="st">&#39;mid&#39;</span>, label<span class="op">=</span><span class="st">&#39;mid&#39;</span>)</span>
<span id="cb54-14"><a href="scientific.html#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="scientific.html#cb54-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">-=</span> <span class="fl">0.5</span></span>
<span id="cb54-16"><a href="scientific.html#cb54-16" aria-hidden="true" tabindex="-1"></a>plt.step(x, y, where<span class="op">=</span><span class="st">&#39;post&#39;</span>, label<span class="op">=</span><span class="st">&#39;post&#39;</span>)</span>
<span id="cb54-17"><a href="scientific.html#cb54-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-18"><a href="scientific.html#cb54-18" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ma.masked_where((y0 <span class="op">&gt;</span> <span class="op">-</span><span class="fl">0.15</span>) <span class="op">&amp;</span> (y0 <span class="op">&lt;</span> <span class="fl">0.15</span>), y <span class="op">-</span> <span class="fl">0.5</span>)</span>
<span id="cb54-19"><a href="scientific.html#cb54-19" aria-hidden="true" tabindex="-1"></a>plt.step(x, y, label<span class="op">=</span><span class="st">&#39;masked (pre)&#39;</span>)</span>
<span id="cb54-20"><a href="scientific.html#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="scientific.html#cb54-21" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb54-22"><a href="scientific.html#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="scientific.html#cb54-23" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb54-24"><a href="scientific.html#cb54-24" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">4</span>)</span>
<span id="cb54-25"><a href="scientific.html#cb54-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>
</div>
<div id="density-plots" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Density plots</h2>
<div class="decocode">
<div style="background-color:#417FB1">
<p><span style="font-size:90%;color:#FFD94C"><i class="fab fa-python"></i> <b>Python</b></span></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="scientific.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://blogs.umass.edu/candela/computational-physics-in-python/</span></span>
<span id="cb55-2"><a href="scientific.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the interference from two point sources, vectorized version.</span></span>
<span id="cb55-3"><a href="scientific.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb55-4"><a href="scientific.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb55-5"><a href="scientific.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> pi,sqrt,sin</span>
<span id="cb55-6"><a href="scientific.html#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="scientific.html#cb55-7" aria-hidden="true" tabindex="-1"></a>wavelength <span class="op">=</span> <span class="fl">5e-2</span>     <span class="co"># wavelength (m) (this is 5cm as in Newman)</span></span>
<span id="cb55-8"><a href="scientific.html#cb55-8" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span>wavelength   <span class="co"># wavenumber (m^-1)</span></span>
<span id="cb55-9"><a href="scientific.html#cb55-9" aria-hidden="true" tabindex="-1"></a>aa0 <span class="op">=</span> <span class="fl">1.0</span>             <span class="co"># amplitude of the waves (arb. units)</span></span>
<span id="cb55-10"><a href="scientific.html#cb55-10" aria-hidden="true" tabindex="-1"></a>separation <span class="op">=</span> <span class="fl">20e-2</span>    <span class="co"># separation of centers (m)</span></span>
<span id="cb55-11"><a href="scientific.html#cb55-11" aria-hidden="true" tabindex="-1"></a>side <span class="op">=</span> <span class="fl">100e-2</span>         <span class="co"># side of the square (m)</span></span>
<span id="cb55-12"><a href="scientific.html#cb55-12" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> <span class="dv">500</span>          <span class="co"># number of grid points along each side</span></span>
<span id="cb55-13"><a href="scientific.html#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="scientific.html#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the positions of the centers of the circles</span></span>
<span id="cb55-15"><a href="scientific.html#cb55-15" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> side<span class="op">/</span><span class="dv">2</span> <span class="op">+</span> separation<span class="op">/</span><span class="dv">2</span></span>
<span id="cb55-16"><a href="scientific.html#cb55-16" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> side<span class="op">/</span><span class="dv">2</span></span>
<span id="cb55-17"><a href="scientific.html#cb55-17" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> side<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> separation<span class="op">/</span><span class="dv">2</span></span>
<span id="cb55-18"><a href="scientific.html#cb55-18" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> side<span class="op">/</span><span class="dv">2</span></span>
<span id="cb55-19"><a href="scientific.html#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="scientific.html#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate an array aas with the sum of the two waves at a grid of points</span></span>
<span id="cb55-21"><a href="scientific.html#cb55-21" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.linspace(<span class="dv">0</span>,side,points)                 <span class="co"># row vector of x&#39;s</span></span>
<span id="cb55-22"><a href="scientific.html#cb55-22" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.linspace(<span class="dv">0</span>,side,points)[:,np.newaxis]   <span class="co"># column vector of y&#39;s</span></span>
<span id="cb55-23"><a href="scientific.html#cb55-23" aria-hidden="true" tabindex="-1"></a>r1s <span class="op">=</span> sqrt((xs<span class="op">-</span>x1)<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(ys<span class="op">-</span>y1)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb55-24"><a href="scientific.html#cb55-24" aria-hidden="true" tabindex="-1"></a>r2s <span class="op">=</span> sqrt((xs<span class="op">-</span>x2)<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(ys<span class="op">-</span>y2)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb55-25"><a href="scientific.html#cb55-25" aria-hidden="true" tabindex="-1"></a>aas <span class="op">=</span> aa0<span class="op">*</span>sin(k<span class="op">*</span>r1s) <span class="op">+</span> aa0<span class="op">*</span>sin(k<span class="op">*</span>r2s)</span>
<span id="cb55-26"><a href="scientific.html#cb55-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-27"><a href="scientific.html#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot</span></span>
<span id="cb55-28"><a href="scientific.html#cb55-28" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>)) </span>
<span id="cb55-29"><a href="scientific.html#cb55-29" aria-hidden="true" tabindex="-1"></a>plt.imshow(aas,origin<span class="op">=</span><span class="st">&#39;lower&#39;</span>,extent<span class="op">=</span>[<span class="dv">0</span>,side,<span class="dv">0</span>,side])</span>
<span id="cb55-30"><a href="scientific.html#cb55-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;x (m)&#39;</span>)</span>
<span id="cb55-31"><a href="scientific.html#cb55-31" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;y (m)&#39;</span>)</span>
<span id="cb55-32"><a href="scientific.html#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.gray()</span></span>
<span id="cb55-33"><a href="scientific.html#cb55-33" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb55-34"><a href="scientific.html#cb55-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<img src="05-scientific_files/figure-html/interference-1.png" width="90%" style="display: block; margin: auto;" />
</div>
<br>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="math.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="voxels.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["matplotlib-with-rmarkdown.pdf", "matplotlib-with-rmarkdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
